define("modules/clean/logging/hive/schemas/search-web_search_activity",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchWebSearchActivityRow=void 0;var r=function(e){this.category="search-web_search_activity",this.active_user_id=null,this.anon_ip=null,this.authed_user_ids=null,this.country=null,this.identity_gid=null,this.locale_browser_header=null,this.locale_user_selected=null,this.referrer=null,this.session_id=null,this.team_id=null,this.team_type=null,this.ua_browser_name=null,this.ua_browser_version=null,this.ua_dist_name=null,this.ua_dist_version=null,this.ua_os_name=null,this.ua_os_version=null,this.user_agent=null,this.user_id=null,e.hasOwnProperty("action_type")&&void 0!==e.action_type&&(this.action_type=e.action_type),e.hasOwnProperty("active_user_id")&&void 0!==e.active_user_id&&(this.active_user_id=e.active_user_id),e.hasOwnProperty("anon_ip")&&void 0!==e.anon_ip&&(this.anon_ip=e.anon_ip),e.hasOwnProperty("authed_user_ids")&&void 0!==e.authed_user_ids&&(this.authed_user_ids=e.authed_user_ids),e.hasOwnProperty("country")&&void 0!==e.country&&(this.country=e.country),e.hasOwnProperty("deleted_filter")&&void 0!==e.deleted_filter&&(this.deleted_filter=e.deleted_filter),e.hasOwnProperty("deleted")&&void 0!==e.deleted&&(this.deleted=e.deleted),e.hasOwnProperty("event_name")&&void 0!==e.event_name&&(this.event_name=e.event_name),e.hasOwnProperty("extra")&&void 0!==e.extra&&(this.extra=e.extra),e.hasOwnProperty("failure_type")&&void 0!==e.failure_type&&(this.failure_type=e.failure_type),e.hasOwnProperty("file_extension")&&void 0!==e.file_extension&&(this.file_extension=e.file_extension),e.hasOwnProperty("file_is_shared")&&void 0!==e.file_is_shared&&(this.file_is_shared=e.file_is_shared),e.hasOwnProperty("file_last_edited")&&void 0!==e.file_last_edited&&(this.file_last_edited=e.file_last_edited),e.hasOwnProperty("file_name")&&void 0!==e.file_name&&(this.file_name=e.file_name),e.hasOwnProperty("file_nsid")&&void 0!==e.file_nsid&&(this.file_nsid=e.file_nsid),e.hasOwnProperty("file_path")&&void 0!==e.file_path&&(this.file_path=e.file_path),e.hasOwnProperty("file_size")&&void 0!==e.file_size&&(this.file_size=e.file_size),e.hasOwnProperty("file_sjid")&&void 0!==e.file_sjid&&(this.file_sjid=e.file_sjid),e.hasOwnProperty("file_type_filters")&&void 0!==e.file_type_filters&&(this.file_type_filters=e.file_type_filters),e.hasOwnProperty("identity_gid")&&void 0!==e.identity_gid&&(this.identity_gid=e.identity_gid),e.hasOwnProperty("latency")&&void 0!==e.latency&&(this.latency=null!==e.latency?e.latency.toString():null),e.hasOwnProperty("locale_browser_header")&&void 0!==e.locale_browser_header&&(this.locale_browser_header=e.locale_browser_header),e.hasOwnProperty("locale_user_selected")&&void 0!==e.locale_user_selected&&(this.locale_user_selected=e.locale_user_selected),e.hasOwnProperty("match_type")&&void 0!==e.match_type&&(this.match_type=e.match_type),e.hasOwnProperty("paper_folder_id")&&void 0!==e.paper_folder_id&&(this.paper_folder_id=e.paper_folder_id),e.hasOwnProperty("paper_pad_id")&&void 0!==e.paper_pad_id&&(this.paper_pad_id=e.paper_pad_id),e.hasOwnProperty("path_scoped")&&void 0!==e.path_scoped&&(this.path_scoped=null!==e.path_scoped?e.path_scoped.toString():null),e.hasOwnProperty("position")&&void 0!==e.position&&(this.position=null===e.position?null:e.position.toString()),e.hasOwnProperty("preview_request_id")&&void 0!==e.preview_request_id&&(this.preview_request_id=e.preview_request_id),e.hasOwnProperty("query_string")&&void 0!==e.query_string&&(this.query_string=e.query_string),e.hasOwnProperty("query_suggestion_count")&&void 0!==e.query_suggestion_count&&(this.query_suggestion_count=e.query_suggestion_count),e.hasOwnProperty("query_suggestion_strings")&&void 0!==e.query_suggestion_strings&&(this.query_suggestion_strings=e.query_suggestion_strings),e.hasOwnProperty("recent_history_map")&&void 0!==e.recent_history_map&&(this.recent_history_map=e.recent_history_map),e.hasOwnProperty("referrer")&&void 0!==e.referrer&&(this.referrer=e.referrer),e.hasOwnProperty("request_id")&&void 0!==e.request_id&&(this.request_id=e.request_id),e.hasOwnProperty("result_count")&&void 0!==e.result_count&&(this.result_count=null!==e.result_count?e.result_count.toString():null),e.hasOwnProperty("result_id")&&void 0!==e.result_id&&(this.result_id=e.result_id),e.hasOwnProperty("session_id")&&void 0!==e.session_id&&(this.session_id=e.session_id),e.hasOwnProperty("source")&&void 0!==e.source&&(this.source=e.source),e.hasOwnProperty("start")&&void 0!==e.start&&(this.start=null!==e.start?e.start.toString():null),e.hasOwnProperty("team_id")&&void 0!==e.team_id&&(this.team_id=e.team_id),e.hasOwnProperty("team_type")&&void 0!==e.team_type&&(this.team_type=e.team_type),e.hasOwnProperty("timestamp")&&void 0!==e.timestamp&&(this.timestamp=e.timestamp),e.hasOwnProperty("timezone_offset")&&void 0!==e.timezone_offset&&(this.timezone_offset=e.timezone_offset),e.hasOwnProperty("type")&&void 0!==e.type&&(this.type=e.type),e.hasOwnProperty("typeahead_session_id")&&void 0!==e.typeahead_session_id&&(this.typeahead_session_id=e.typeahead_session_id),e.hasOwnProperty("ua_browser_name")&&void 0!==e.ua_browser_name&&(this.ua_browser_name=e.ua_browser_name),e.hasOwnProperty("ua_browser_version")&&void 0!==e.ua_browser_version&&(this.ua_browser_version=e.ua_browser_version),e.hasOwnProperty("ua_dist_name")&&void 0!==e.ua_dist_name&&(this.ua_dist_name=e.ua_dist_name),e.hasOwnProperty("ua_dist_version")&&void 0!==e.ua_dist_version&&(this.ua_dist_version=e.ua_dist_version),e.hasOwnProperty("ua_os_name")&&void 0!==e.ua_os_name&&(this.ua_os_name=e.ua_os_name),e.hasOwnProperty("ua_os_version")&&void 0!==e.ua_os_version&&(this.ua_os_version=e.ua_os_version),e.hasOwnProperty("user_agent")&&void 0!==e.user_agent&&(this.user_agent=e.user_agent),e.hasOwnProperty("user_id")&&void 0!==e.user_id&&(this.user_id=e.user_id),e.hasOwnProperty("view_type")&&void 0!==e.view_type&&(this.view_type=e.view_type),e.hasOwnProperty("viewport")&&void 0!==e.viewport&&(this.viewport=e.viewport),e.hasOwnProperty("search_scoped_to_account_id")&&void 0!==e.search_scoped_to_account_id&&(this.search_scoped_to_account_id=e.search_scoped_to_account_id),e.hasOwnProperty("action_source")&&void 0!==e.action_source&&(this.action_source=e.action_source),e.hasOwnProperty("tag_suggestions_strings")&&void 0!==e.tag_suggestions_strings&&(this.tag_suggestions_strings=e.tag_suggestions_strings),e.hasOwnProperty("tag_suggestions_count")&&void 0!==e.tag_suggestions_count&&(this.tag_suggestions_count=e.tag_suggestions_count),e.hasOwnProperty("dimension_filter")&&void 0!==e.dimension_filter&&(this.dimension_filter=e.dimension_filter),Object.seal(this)};t.SearchWebSearchActivityRow=r})),define("modules/clean/react/starred/browse_exports",["require","exports","modules/clean/react/home/resource_id_types","modules/clean/react/starred/actions","modules/clean/react/starred/browse_update","modules/clean/react/starred/constants","modules/clean/react/starred/id_type_pair","modules/clean/react/starred/star","modules/clean/react/starred/store"],(function(e,t,r,n,s,i,a,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StarredStore=t.Star=t.itemNameFromStarrableItem=t.idTypePairFromStarrableItem=t.StarredSource=t.checkForMissingStarredData=t.StarredActions=t.HOME_RESOURCE_ID_TYPE=void 0,Object.defineProperty(t,"HOME_RESOURCE_ID_TYPE",{enumerable:!0,get:function(){return r.HOME_RESOURCE_ID_TYPE}}),Object.defineProperty(t,"StarredActions",{enumerable:!0,get:function(){return n.StarredActions}}),Object.defineProperty(t,"checkForMissingStarredData",{enumerable:!0,get:function(){return s.checkForMissingStarredData}}),Object.defineProperty(t,"StarredSource",{enumerable:!0,get:function(){return i.StarredSource}}),Object.defineProperty(t,"idTypePairFromStarrableItem",{enumerable:!0,get:function(){return a.idTypePairFromStarrableItem}}),Object.defineProperty(t,"itemNameFromStarrableItem",{enumerable:!0,get:function(){return a.itemNameFromStarrableItem}}),Object.defineProperty(t,"Star",{enumerable:!0,get:function(){return o.Star}}),Object.defineProperty(t,"StarredStore",{enumerable:!0,get:function(){return l.StarredStore}})})),define("modules/clean/react/starred/browse_update",["require","exports","modules/clean/react/starred/actions","modules/clean/react/starred/id_type_pair","modules/clean/react/starred/store"],(function(e,t,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkForMissingStarredData=void 0,t.checkForMissingStarredData=function(e){var t=e.items,i=e.isNonUserRelativeContext,a=e.user;if(!i){var o=t.map(n.idTypePairFromStarrableItem).filter((function(e){return!(!e.id||s.StarredStore.hasIdTypePair(e))}));o.length&&r.StarredActions.fetchStatuses(a.role,o)}}})),define("modules/clean/search/search_results/view",["require","exports","tslib","immutable","lodash","react","dig-components/typography","spectrum/media_table/index","spectrum/table/index","spectrum/tip_card/index","modules/clean/filepath/filepath","modules/clean/history","modules/clean/react/async/loadable","modules/clean/react/browse/browse_files_view","modules/clean/react/browse/models","modules/clean/react/files_view/column_helpers","modules/clean/react/files_view/constants","modules/clean/react/files_view/controller","modules/clean/react/files_view/resizing/column_size_context","modules/clean/react/files_view/types","modules/clean/react/files_view/sort_types","modules/clean/react/files_view/view_type","modules/clean/search/constants","modules/clean/search/search_helpers","modules/clean/search/types","modules/core/i18n"],(function(e,t,r,n,s,i,a,o,l,u,c,d,g,p,_,h,m,f,S,y,v,E,T,w,F,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchResultsView=void 0,n=r.__importStar(n),s=r.__importStar(s),i=r.__importDefault(i),c=r.__importStar(c),d=r.__importDefault(d),S=r.__importStar(S),T=r.__importStar(T),w=r.__importStar(w);var A=(function(e){function t(t){var n=e.call(this,t)||this;return n.updateScrollContainerWidth=function(){n.props.scrollContainer&&null!==n.props.scrollContainer.current&&n.setState({scrollContainerWidth:p.getWidthOfElement(n.props.scrollContainer.current)})},n._handleScroll=function(){n.props.onScroll()},n._ensureFileViewerClosedIfNotPreviewing=function(){var e=d.default.deconstruct_url().qargs;n.props.ensureFileViewerClosedIfNotPreviewing(e)},n._handleRemoveAllFilters=function(e){e.preventDefault(),n.props.onSearchFiltersChanged({path:"/",fileCategories:r.__assign({},T.FILE_CATEGORIES_UNCHECKED),dateTaken:F.DateTaken.Any,selectedDimensions:[]})},n._getRemoveAllFiltersViewUrl=function(){var e=n.props,t=e.user,r=e.latestQuery,s=e.searchSessionId;return w.buildSearchURL({user:t,searchPath:"/",normalizedQuery:r,searchSessionId:s,searchToken:w.getSearchCsrfToken(),qargs:{file_categories:void 0}}).toString()},n._renderEmptyFolderSubtitle=function(){var e=n.props,t=e.path,r=e.fileCategories;return c.paths_are_equal(t,"/")&&!w.fileCategoriesSet(r)?C.intl.formatMessage({id:"PtdLen",defaultMessage:"Try different keywords"}):C.intl.formatMessage({id:"00FN2D",defaultMessage:"Try <LinkScope>resetting all filters</LinkScope>"},{LinkScope:function(e){return i.default.createElement("a",{href:n._getRemoveAllFiltersViewUrl(),onClick:n._handleRemoveAllFilters},e)}})},n._renderEmptyFolderView=function(){var e=C.intl.formatMessage({id:"ZY55+d",defaultMessage:"No results found"});return i.default.createElement("div",null,i.default.createElement("div",{className:"u-font-center u-pad-top-xl"},i.default.createElement("div",{className:"search__view--illustration"},i.default.createElement(I,null)),i.default.createElement(a.Title,{className:"u-font-strong empty-folder-table-title"},e),i.default.createElement(a.Text,null,n._renderEmptyFolderSubtitle())))},n.state={viewTypeColumns:n._generateViewTypeColumns(),searchResultsWithUserDefinedItem:n._generateSearchResultsWithUserDefinedItem(t.searchResults)},n}return r.__extends(t,e),t.prototype.componentDidMount=function(){window.addEventListener("scroll",this._handleScroll),this.props.isColumnResizingEnabled&&(this.updateScrollContainerWidth(),window.addEventListener("resize",this.updateScrollContainerWidth))},t.prototype.componentDidUpdate=function(){this.props.isColumnResizingEnabled&&!this.state.scrollContainerWidth&&this.updateScrollContainerWidth()},t.prototype.componentWillReceiveProps=function(e){var t=this.props,r=t.currentSort,n=t.searchResults,s=e.viewType,i=e.currentSort,a=e.searchResults,o=this.state.viewTypeColumns;r&&i&&o&&!w.areSortOrdersEqual(r,i)&&this.setState({viewTypeColumns:this._updateViewTypeColumns(o,s,i)}),n!==a&&this.setState({searchResultsWithUserDefinedItem:this._generateSearchResultsWithUserDefinedItem(a)})},t.prototype.componentWillUnmount=function(){window.removeEventListener("scroll",this._handleScroll),d.default.remove_callback("/search",this._ensureFileViewerClosedIfNotPreviewing),this.props.isColumnResizingEnabled&&window.removeEventListener("resize",this.updateScrollContainerWidth)},t.prototype._getLoadingState=function(){var e=this.props.loadingState;return e===T.SearchLoadingState.LOADING_FIRST_PAGE?y.LoadingState.LOADING_FIRST_PAGE:e===T.SearchLoadingState.LOADING_ADDITIONAL_PAGE?y.LoadingState.LOADING_REMAINING_PAGES:y.LoadingState.LOADED},t.prototype._renderSearchResultItems=function(e){var t=this.props,n=t.getOverflowMenuActions,a=t.onFocusSearchBar,o=t.onLocationLinkClick,l=t.onNavigateToFileOrFolder,u=t.onNavigateToParentFolder,c=t.onOpenFileSharedWithMe,d=t.onOpenPaper,g=t.context,p=t.fileRename,_=t.searchResults,h=t.getIsFileJumping,m=t.isFileViewerShown,v=t.arePostTTIModulesLoaded,E=t.handleComponentTTI,w=t.onSelectionChange,F=t.selectedFiles,C=t.selection,A=t.setFileUploaderPath,I=t.user,L=t.path,b=t.filesViewActionHandlers,D=t.renderSharedWithController,P=t.hrefForFile,O=t.starredState,x=t.onStarClick,M=t.sharingServiceInfo,N=t.currentSort,Q=t.onSortChange,k=t.onRangeInView,q=t.scrollContainer,V=t.filteredContactName,U=t.viewTypeScope,W=t.isColumnResizingEnabled,H=t.useSkinnyCheckboxes,z=this.state.viewTypeColumns;return i.default.createElement(f.FilesViewController,r.__assign({id:T.SEARCH_FILES_VIEW_ID},b,{getOverflowMenuActions:n,onLocationLinkClick:o,onNavigateToFileOrFolder:l,onNavigateToParentFolder:u,onOpenFileSharedWithMe:c,onOpenPaper:d,context:g,customEmptyFolderView:this._renderEmptyFolderView,createNewFolderState:y.NewFolderCreationState.CREATE_FOLDER_INACTIVE,fileRename:p,getIsFileJumping:h,isFileViewerShown:m,isSearchMode:!0,arePostTTIModulesLoaded:v,loadingState:this._getLoadingState(),onComponentTTI:E,onSelectionChange:w,onFocusSearchBar:a,path:L,selectedFiles:F,selection:C,setFileUploaderPath:A,showFileUploaderModal:s.noop,user:I,totalNumFiles:_.size,responsive:e,columns:this._generateColumns(e),renderSharedWithController:D,hrefForFile:P,viewTypes:T.SearchViewTypes,viewTypeScope:U,starredState:O,stickyOffsetTop:-1,sharingServiceInfo:M,onStarClick:x,items:this._generateFilesViewItems(),isStickyColumnHeader:!0,viewTypeColumns:z,onColumnsChanged:s.noop,currentSort:N,onSortChange:Q,highDensity:!0,onRangeInView:k,scrollContainer:q,filteredContactName:V,isActionBarEnabled:!0,inlineActionBar:R,enableUnity:!0,isColumnResizingEnabled:W,columnResizeStorageSetting:S.noStorage,scrollContainerWidth:this.state.scrollContainerWidth,expManualTagging:this.props.searchResultsExperiments.expManualTagging,useSkinnyCheckboxes:H,mediaFiltersVariant:this.props.mediaFiltersVariant}))},t.prototype._generateColumns=function(e){var t=this.props.viewType,r=this.state.viewTypeColumns;return r?r[t]:m.SEARCH_LIST_VIEW_COLUMNS},t.prototype._generateViewTypeColumns=function(){var e,t=this.props,r=t.viewType,n=t.currentSort,s=((e={})[E.ViewType.List]=m.SEARCH_LIST_VIEW_SORT_ENABLED_COLUMNS,e[E.ViewType.Grid]=m.SEARCH_GRID_VIEW_SORT_ENABLED_COLUMNS,e[E.ViewType.LargeGrid]=m.SEARCH_GRID_VIEW_SORT_ENABLED_COLUMNS,e);return n?this._updateViewTypeColumns(s,r,n):s},t.prototype._isDeletedFile=function(e){return e instanceof _.File&&e.isDeleted},t.prototype._generateSearchResultsWithUserDefinedItem=function(e){var t=this,r=e.filter((function(e){return t._isDeletedFile(e)}));if(r.size>0){var s=e.filter((function(e){return!t._isDeletedFile(e)})),a=new _.UserDefinedItem({renderUserDefinedItemRow:function(e){var t=e.rowIndex,r=e.topOffset;return i.default.createElement(o.CulledMediaRow,{"aria-rowindex":void 0!==t?t+1:void 0,className:"brws-user-defined-item-row",topOffset:r},i.default.createElement(l.TableCell,{key:"checkboxCell",className:"brws-checkbox-cell"}),i.default.createElement(l.TableCell,{className:"mc-media-cell"},i.default.createElement(u.TipCard,{className:"search-results__deleted-files-notice","non-dismissible":!0},C.intl.formatMessage({id:"GYhJ5f",defaultMessage:"Deleted content isnâ€™t sorted by last modified"}))))}});return s.concat([a]).concat(r)}return n.List()},t.prototype._generateFilesViewItems=function(){var e=this,t=this.props,r=t.searchResults,n=t.viewType,s=t.currentSort,i=r.filter((function(t){return e._isDeletedFile(t)}));return n===E.ViewType.List&&s&&s.sortField!==v.SortField.RELEVANCE&&i.size>0?this.state.searchResultsWithUserDefinedItem:r},t.prototype._updateViewTypeColumns=function(e,t,n){var s,i,a=e[t];if(t===E.ViewType.List)return r.__assign(r.__assign({},e),((s={})[t]=h.swapColumns(a,a[1].sortField,n.sortField),s));var o=e[E.ViewType.List];return r.__assign(r.__assign({},e),((i={})[t]=h.swapColumns(a,a[0].sortField,n.sortField),i[E.ViewType.List]=h.swapColumns(o,o[1].sortField,n.sortField),i))},t.prototype.render=function(){var e=this.props.responsive;return i.default.createElement("div",{className:"search-results"},this._renderSearchResultItems(e))},t.displayName="SearchResultsView",t})(i.default.Component);t.SearchResultsView=A;var R=g.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/search/single_page/search_inline_action_bar"],t,r)})).then(r.__importStar)];case 1:return[2,t.sent().SearchInlineActionBar]}}))}))}}),I=g.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["dig-illustrations/spot/dog-digs"],t,r)})).then(r.__importStar)];case 1:return[2,t.sent().DogDigsSpot]}}))}))}})})),define("modules/clean/search/single_page/api",["require","exports","api_v2/user_client","modules/clean/contacts/data_v2"],(function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getQuerySuggestions=t.getContactApiClient=void 0;var s=function(e){var t=this;this.filterContact=function(e){return!e.group_id&&!!e.dbx_account_id},this.fetchContacts=function(e){return new Promise((function(r,n){""===e?t.dataSource.getAll(r):t.dataSource.search(e,r)}))},this.dataSource=new n.ContactsDataSourceV2(e,this.filterContact)},i=null;t.getContactApiClient=function(e){return i||(i=new s(e)),i},t.getQuerySuggestions=function(e,t,n,s){return(new r.UserApiV2Client).ns("files").rpc("get_query_suggestions",{query:t,max_results:n,search_session_id:s},{subjectUserId:e})}})),define("modules/clean/search/single_page/data/action_creators/index",["require","exports","tslib","modules/clean/browse_uri_interface","modules/clean/cloud_docs/open_with_utils","modules/clean/cloud_docs/preferred_editor_utils","modules/clean/cloud_docs/types","modules/clean/file_operations/notifications","modules/clean/filepath/filepath","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/api","modules/core/browser","modules/core/browser","modules/clean/react/browse/constants","modules/clean/react/browse/data/selectors","modules/clean/react/browse/logger_util","modules/clean/react/browse/models","modules/clean/react/extensions/data/store","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/sort_types","modules/clean/react/files_view/util","modules/clean/react/selection","modules/clean/react/starred/browse_update","modules/clean/search/api","modules/clean/search/api_helpers","modules/clean/search/constants","modules/clean/search/search_helpers","modules/clean/search/single_page/api","modules/clean/search/single_page/constants","modules/clean/search/single_page/data/selectors/experiments","modules/clean/search/single_page/data/selectors/experiments","modules/clean/search/single_page/data/action_creators/common","modules/clean/search/single_page/data/selectors/index","modules/clean/search/single_page/data/types","modules/clean/search/single_page/logger","modules/clean/search/single_page/navigation","modules/clean/search/single_page/utils","modules/clean/search/store_helpers","modules/clean/search/types","modules/core/persistence/storage","modules/clean/web_timing_logger","modules/clean/web_user_action_events","modules/constants/python","modules/core/exception","modules/clean/tagging/data/action_creators","modules/clean/tagging/data/selectors/index","modules/clean/tagging/experiments","modules/clean/tagging/utils","modules/clean/media_filters/gating","modules/clean/search/single_page/media_filters/media_api","modules/clean/search/single_page/data/action_creators/popular_filters"],(function(e,t,r,n,s,i,a,o,l,u,c,d,g,p,_,h,m,f,S,y,v,E,T,w,F,C,A,R,I,L,b,D,P,O,x,M,N,Q,k,q,V,U,W,H,z,G,B,Y,j,K,Z,J){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleNavigateToFileOrFolder=t.shouldStartNewSearchSession=t.resetFilters=t.setFilters=t.logQueryCompleted=t.setQueryStartTime=t.setHighlightedRow=t.restoreFiles=t.purgeFiles=t.removeResults=t.updateResults=t.setResults=t.setLastQueryWithTagsSuggestionsLoaded=t.dismissTagsSuggestions=t.fetchTagsSuggestions=t.setLastQueryWithQuerySuggestionsLoaded=t.dismissQuerySuggestions=t.fetchQuerySuggestions=t.clearAllHistory=t.addQueryToHistory=t.loadHistory=t.stopAndLogDwellTime=t.startDwellTime=t.handleComponentTTI=t.resetTTI=t.fetchFirstPage=t._performSearch=t.performSearch=t.setSessionId=t.setPreviewCommentsThreadId=t.setPreviewFile=t.clearSelection=t.setSelection=t.fetchNextPage=t.updateFromUrl=t.setMediaData=t.setSelectedDimensions=t.setDateTaken=t.dismissPeopleSuggestions=t.fetchPeopleSuggestions=t.setFilteredSearchSuggestion=t.setFilteredAccountId=t.setSortOrder=t.setSearchType=t.setFileCategories=t.setPath=t.setQuery=t.setExperiments=t.setUser=t.setVariant=t.clear=void 0,o=r.__importStar(o),l=r.__importStar(l),u=r.__importStar(u),c=r.__importStar(c),d=r.__importStar(d),_=r.__importStar(_),h=r.__importStar(h),S=r.__importStar(S),y=r.__importStar(y),b=r.__importStar(b),O=r.__importStar(O),M=r.__importStar(M),k=r.__importStar(k),G=r.__importStar(G),B=r.__importStar(B);var X=null,$=null,ee=null,te=null;function re(e){var t=O.normalizedQuery(e()),r=O.filteredAccountId(e()),n=K.isMediaFiltersEnabled(D.mediaFiltersVariant(e())),s=O.dateTaken(e()),i=O.selectedDimensions(e()),a=O.filteredSuggestion(e());return C.skipNonValidSearchArgs(t,r,n,s,i,a)}t.clear=function(){return function(e,t){var r="/";try{r=_.path(t())}catch(e){}null!==X&&clearTimeout(X),e({type:x.ActionTypes.SET_QUERY,payload:{query:""}}),e({type:x.ActionTypes.CLEAR_RESULTS}),e({type:x.ActionTypes.SET_PATH,payload:{path:r}}),e({type:x.ActionTypes.SET_FILE_CATEGORIES,payload:{fileCategories:A.FILE_CATEGORIES_UNCHECKED}}),e(oe({loadingState:A.SearchLoadingState.ZERO_QUERY})),e({type:x.ActionTypes.SET_FILTERED_ACCOUNT_ID,payload:{filteredAccountId:void 0}}),e({type:x.ActionTypes.SET_DATE_TAKEN,payload:{dateTaken:0}}),e({type:x.ActionTypes.SET_SELECTED_DIMENSIONS,payload:{selectedDimensions:[]}})}},t.setVariant=function(e){var t=e.variant;return{type:x.ActionTypes.SET_VARIANT,payload:{variant:t}}},t.setUser=function(e){var t=e.user,r=e.options;return{type:x.ActionTypes.SET_USER,payload:{user:t,options:r}}},t.setExperiments=function(e){var t=e.experiments;return{type:x.ActionTypes.SET_EXPERIMENTS,payload:{experiments:t}}},t.setQuery=function(e){var r=e.query,n=e.alwaysTriggerSearch;return function(e,s){var i=k.normalize(r),a=i!==O.normalizedQuery(s()),o=""===O.normalizedQuery(s())&&a,l=t.shouldStartNewSearchSession(s(),{query:r}),u=b.isSearchAsYouTypeEnabled(s())||n,c=O.user(s()),d=O.variant(s());if(c&&(e({type:x.ActionTypes.SET_QUERY,payload:{query:r}}),M.logQueryTyped(r),a)){e(t.resetTTI()),""===i&&(e(t.setLastQueryWithQuerySuggestionsLoaded({lastQueryWithQuerySuggestionsLoaded:i})),e(de({lastQueryWithPeopleSuggestionsLoaded:i})),Y.isTaggingEnabled(b.manualTaggingVariant(s()))&&e(t.setLastQueryWithTagsSuggestionsLoaded({lastQueryWithTagsSuggestionsLoaded:i}))),l&&e(t.setSessionId({sessionId:Q.generateRandomId()})),u&&(o||l)&&e(oe({loadingState:A.SearchLoadingState.LOADING_FIRST_PAGE})),ge(),u&&O.isFullPage(s())&&N.searchNavigationManager.set(O.searchUrl(s()));var g=O.filteredAccountId(s()),p=K.isMediaFiltersEnabled(D.mediaFiltersVariant(s())),_=O.dateTaken(s()),h=O.selectedDimensions(s()),m=O.filteredSuggestion(s());if(C.skipNonValidSearchArgs(i,g,p,_,h,m)&&u)return e(ie()),void e(oe({loadingState:A.SearchLoadingState.ZERO_QUERY}));if(i&&"full-page"===d){if(K.isPopularFiltersSearchEnabled(D.mediaFiltersVariant(s()))&&(te=pe(te),te=setTimeout((function(){var t;(null===(t=O.filteredSuggestion(s()))||void 0===t?void 0:t.type)||J.fetchPopularFilters(e,s,re(s)),te=null}),L.POPULAR_FILTERS_DEBOUNCE)),ee=pe(ee),ee=setTimeout((function(){e(t.fetchQuerySuggestions({query:i,maxResults:L.SEARCH_POSTERIOR_QUERY_SUGGESTIONS_CAPACITY})),ee=null}),L.SEARCH_SUGGESTIONS_DEBOUNCE),Y.isTaggingEnabled(b.manualTaggingVariant(s()))){var f=R.normalizeForTagsSuggestions(r);e(t.fetchTagsSuggestions({query:f}))}O.filteredAccountId(s())||e(t.fetchPeopleSuggestions({query:i,user:c}))}u&&(X=setTimeout((function(){t.fetchFirstPage(e,s),X=null}),L.SEARCH_QUERY_DEBOUNCE))}}},t.setPath=function(e){var r=e.path,n=e.viewport;return function(e,s){l.paths_are_equal(r,O.path(s()))||(e({type:x.ActionTypes.SET_PATH,payload:{path:r}}),n&&M.logScopeChipChanged(r,n),t._performSearch(e,s))}},t.setFileCategories=function(e){var r=e.fileCategories;return function(e,n){if(R.fileCategoriesToString(r)!==O.fileCategoriesString(n())){if(e({type:x.ActionTypes.SET_FILE_CATEGORIES,payload:{fileCategories:r}}),O.isFullPage(n())&&N.searchNavigationManager.set(O.searchUrl(n()),!0),re(n))return e(ie()),void e(oe({loadingState:A.SearchLoadingState.ZERO_QUERY}));t._performSearch(e,n)}}},t.setSearchType=function(e){var r=e.searchType;return function(e,n){r!==O.searchType(n())&&(e(t.stopAndLogDwellTime()),e({type:x.ActionTypes.SET_SEARCH_TYPE,payload:{searchType:r}}),t._performSearch(e,n))}},t.setSortOrder=function(e){var r=e.sortOrder;return function(e,n){fe(r,O.sortOrder(n()))||(e({type:x.ActionTypes.SET_SORT_ORDER,payload:{sortOrder:r}}),M.logSortOrderChanged(r),O.isFullPage(n())&&N.searchNavigationManager.set(O.searchUrl(n()),!0),e(oe({loadingState:A.SearchLoadingState.LOADING_FIRST_PAGE})),t._performSearch(e,n))}},t.setFilteredAccountId=function(e){var r=e.filteredAccountId;return function(e,n){if(r!==O.filteredAccountId(n())){r||M.logPeopleFilterRemoved(),e({type:x.ActionTypes.SET_FILTERED_ACCOUNT_ID,payload:{filteredAccountId:r}}),O.isFullPage(n())&&N.searchNavigationManager.set(O.searchUrl(n()));var s=O.normalizedQuery(n()),i=K.isMediaFiltersEnabled(D.mediaFiltersVariant(n())),a=O.dateTaken(n()),o=O.selectedDimensions(n()),l=O.filteredSuggestion(n());if(C.skipNonValidSearchArgs(s,r,i,a,o,l))return e(ie()),void e(oe({loadingState:A.SearchLoadingState.ZERO_QUERY}));t._performSearch(e,n)}}},t.setFilteredSearchSuggestion=function(e){var r=e.type,n=e.query;return n||M.logTypeaheadSuggestionRemoved(),function(e,s){e({type:x.ActionTypes.SET_FILTERED_SEARCH_SUGGESTION,payload:{type:r,query:n}}),O.isFullPage(s())&&N.searchNavigationManager.set(O.searchUrl(s()));var i=O.normalizedQuery(s()),a=K.isMediaFiltersEnabled(D.mediaFiltersVariant(s())),o=O.filteredAccountId(s()),l=O.dateTaken(s()),u=O.selectedDimensions(s()),c=O.filteredSuggestion(s());if(C.skipNonValidSearchArgs(i,o,a,l,u,c))return e(ie()),void e(oe({loadingState:A.SearchLoadingState.ZERO_QUERY}));t._performSearch(e,s)}},t.fetchPeopleSuggestions=function(e){var t=e.user,n=e.query;return function(e,s){return r.__awaiter(this,void 0,void 0,(function(){var i,a,o,l;return r.__generator(this,(function(r){switch(r.label){case 0:if(i=k.normalize(n),a=O.peopleSuggestionsCache(s())[i]){if((o=a.loadingState)===q.PeopleSuggestionsLoadingState.LOADING)return[2];if(o===q.PeopleSuggestionsLoadingState.LOADED)return e(de({lastQueryWithPeopleSuggestionsLoaded:i})),[2];if(o===q.PeopleSuggestionsLoadingState.DISMISSED)return e(ce({normalizedQuery:i,peopleSuggestionsData:{loadingState:q.PeopleSuggestionsLoadingState.LOADED}})),e(de({lastQueryWithPeopleSuggestionsLoaded:i})),[2]}return e(ce({normalizedQuery:i,peopleSuggestionsData:{contacts:[],loadingState:q.PeopleSuggestionsLoadingState.LOADING}})),[4,I.getContactApiClient(t).fetchContacts(i)];case 1:return l=r.sent(),M.logPeopleFilterResponse(l.length),e(ce({normalizedQuery:i,peopleSuggestionsData:{contacts:l,loadingState:q.PeopleSuggestionsLoadingState.LOADED}})),e(de({lastQueryWithPeopleSuggestionsLoaded:i})),[2]}}))}))}},t.dismissPeopleSuggestions=function(e){var t=e.query;return function(e,r){var n=k.normalize(t),s=O.peopleSuggestionsCache(r())[n];s&&s.loadingState===q.PeopleSuggestionsLoadingState.LOADED&&e(ce({normalizedQuery:n,peopleSuggestionsData:{loadingState:q.PeopleSuggestionsLoadingState.DISMISSED}}))}},t.setDateTaken=function(e){var r=e.dateTaken;return function(e,n){if(r!==O.dateTaken(n())){e({type:x.ActionTypes.SET_DATE_TAKEN,payload:{dateTaken:r}});var s=O.getPage(n());M.logDateTakenChange(s,r),O.isFullPage(n())&&N.searchNavigationManager.set(O.searchUrl(n()));var i=O.normalizedQuery(n()),a=O.filteredAccountId(n()),o=K.isMediaFiltersEnabled(D.mediaFiltersVariant(n())),l=O.selectedDimensions(n()),u=O.filteredSuggestion(n());if(C.skipNonValidSearchArgs(i,a,o,r,l,u))return e(ie()),void e(oe({loadingState:A.SearchLoadingState.ZERO_QUERY}));t._performSearch(e,n)}}},t.setSelectedDimensions=function(e){var r=e.selectedDimensions;return function(e,n){if(R.dimensionsToURLParam(r)!==R.dimensionsToURLParam(O.selectedDimensions(n()))){e({type:x.ActionTypes.SET_SELECTED_DIMENSIONS,payload:{selectedDimensions:r}});var s=O.getPage(n());M.logDimensionFilterChange(s,r),O.isFullPage(n())&&N.searchNavigationManager.set(O.searchUrl(n()));var i=O.normalizedQuery(n()),a=O.filteredAccountId(n()),o=K.isMediaFiltersEnabled(D.mediaFiltersVariant(n())),l=O.dateTaken(n()),u=O.filteredSuggestion(n());if(C.skipNonValidSearchArgs(i,a,o,l,r,u))return e(ie()),void e(oe({loadingState:A.SearchLoadingState.ZERO_QUERY}));t._performSearch(e,n)}}},t.setMediaData=function(e,t,n){return function(s,i){return r.__awaiter(void 0,void 0,void 0,(function(){var i,a;return r.__generator(this,(function(r){switch(r.label){case 0:return[4,Z.enrichedMediaDataFromApi(e,t)];case 1:return i=r.sent(),M.logEnrichedMediaDataReceived((null==i?void 0:i.enriched_media_data)||[],n),void 0===(null==i?void 0:i.enriched_media_data)?[2]:(a=i.enriched_media_data,s({type:x.ActionTypes.SET_MEDIA_DATA,payload:{filesMediaData:a}}),[2])}}))}))}},t.updateFromUrl=function(e){var r=e.path,n=e.query,s=e.search_session_id,i=e.preview,a=e.file_categories,o=e.search_type,l=e.search_order_by,u=e.search_reverse_order,c=e.search_account_id,d=e.search_from,g=e.search_date_taken,p=e.search_dimensions;return function(e,_){var h=!1,m=n||"",f=a||"";m!==O.query(_())&&(h=!0,e({type:x.ActionTypes.SET_QUERY,payload:{query:m}})),void 0!==r&&r!==O.path(_())&&(h=!0,e({type:x.ActionTypes.SET_PATH,payload:{path:r}})),f!==O.fileCategoriesString(_())&&(h=!0,e({type:x.ActionTypes.SET_FILE_CATEGORIES,payload:{fileCategories:R.fileCategoriesFromString(f)}})),void 0!==o&&o!==O.searchType(_())&&(h=!0,e({type:x.ActionTypes.SET_SEARCH_TYPE,payload:{searchType:o}}));var S=he(d),y={sortField:_e(l),sortDirection:me(u)};if(fe(y,O.sortOrder(_()))||(e({type:x.ActionTypes.SET_SORT_ORDER,payload:{sortOrder:y}}),M.logSortOrderChanged(y),h=!0),c!==O.filteredAccountId(_())){h=!0,e({type:x.ActionTypes.SET_FILTERED_ACCOUNT_ID,payload:{filteredAccountId:c}});var v=O.user(_());v&&e(t.fetchPeopleSuggestions({query:"",user:v}))}void 0!==s&&s!==O.sessionId(_())&&(h=!0,e(t.setSessionId({sessionId:s}))),i!==O.previewFileId(_())&&e({type:x.ActionTypes.SET_PREVIEW_FILE_ID,payload:{previewFileId:""===i?void 0:i}}),void 0!==g&&""!==g&&Number(g)!==O.dateTaken(_())&&e({type:x.ActionTypes.SET_DATE_TAKEN,payload:{dateTaken:Number(g)}}),void 0!==p&&""!==p&&R.dimensionsToURLParam(O.selectedDimensions(_()))!==p&&e({type:x.ActionTypes.SET_SELECTED_DIMENSIONS,payload:{selectedDimensions:R.parseDimensionsUrlParam(p)}}),h&&(re(_)?(e(ie()),e(oe({loadingState:A.SearchLoadingState.ZERO_QUERY}))):e((function(e,r){return t._performSearch(e,r,S)})))}},t.fetchNextPage=function(){return function(e,n){var s=O.user(n()),i=O.path(n()),a=O.normalizedQuery(n()),o=O.hasMoreResults(n()),l=O.cursor(n()),u=O.searchType(n()),c=O.fileCategoriesString(n()),d=O.filteredAccountId(n()),g=P.apiCommonFields(n()),p=O.dateTaken(n()),_=O.selectedDimensions(n()),h=O.filteredSuggestion(n()),m=K.isMediaFiltersEnabled(D.mediaFiltersVariant(n()));s&&o&&!C.skipNonValidSearchArgs(a,d,m,p,_,h)&&(O.numResults(n())>0&&e(oe({loadingState:A.SearchLoadingState.LOADING_ADDITIONAL_PAGE})),F.searchApiClient.loadPartialResults(r.__assign(r.__assign({},g),{start:O.nextPageOffset(n()),cursor:l,onSuccess:function(r){var o=r.searchResults;if(!P.hasSearchChanged(n(),{query:a,path:i,filteredAccountId:d,searchType:u,fileCategoriesString:c,dateTaken:p,dimensions:_})){e(ae({searchResults:o,loadingState:A.SearchLoadingState.LOADED})),Y.isTaggingEnabled(b.manualTaggingVariant(n()))&&e(G.fetchTagsForFiles({user:s,files:o.results.filter(E.isFile)})),m&&e(t.setMediaData(s,o.results.filter(Se),a)),e(t.logQueryCompleted()),o.results.length&&f.initializeStore(s,o.results.filter(Se)),w.checkForMissingStarredData({items:o.results,user:s});var l=L.SEARCH_MIN_PAGE_SIZE;o.hasMore&&o.results.length<l&&e(t.fetchNextPage())}},onError:function(e){var t=(new Date).getTime()-O.queryStartTime(n());M.logQueryFailed(t,e,A.SearchOriginPathway.WEB),z.reportException({err:new Error(e),severity:"non-critical",tags:["js:search"]})}})))}},t.setSelection=function(e){var t=e.selection,r=e.actionSource,n=e.skipLogging;return function(e,s){if(!n){var i=s(),a=h.makeSelectionEvent(O.selection(i),t),o=a.event,l=a.itemId,u=O.selectResultById(i,{id:l});if(u){var c=h.countFilesAndFolders(O.selectFilesForSelection(i,{selection:t})),d=c.num_files_selected,g=c.num_folders_selected;M.logResultAction(o,O.resultsList(i),u,void 0,r,{num_files_selected:String(d),num_folders_selected:String(g)})}}e({type:x.ActionTypes.SET_SELECTION,payload:{selection:t,actionSource:r,skipLogging:n}}),ye(e,s,t)}},t.clearSelection=function(e){var r=void 0===e?{}:e,n=r.actionSource,s=r.skipLogging;return t.setSelection({actionSource:n,skipLogging:s,selection:T.createSelection()})},t.setPreviewFile=function(e){var r=e.previewFileId;return function(e,n){e(void 0===r?t.startDwellTime():t.stopAndLogDwellTime()),e({type:x.ActionTypes.SET_PREVIEW_FILE_ID,payload:{previewFileId:r}}),O.isFullPage(n())&&N.searchNavigationManager.set(O.searchUrl(n()),!0)}},t.setPreviewCommentsThreadId=function(e){var t=e.previewCommentsThreadId;return{type:x.ActionTypes.SET_PREVIEW_COMMENTS_THREAD_ID,payload:{previewCommentsThreadId:t}}},t.setSessionId=function(e){var t=e.sessionId;return{type:x.ActionTypes.SET_SESSION_ID,payload:{sessionId:t}}},t.performSearch=function(){return function(e,r){re(r)?(e(ie()),e(oe({loadingState:A.SearchLoadingState.ZERO_QUERY})),O.isFullPage(r())&&N.searchNavigationManager.set(O.searchUrl(r()))):O.isFullPage(r())?(N.searchNavigationManager.set(O.searchUrl(r())),t._performSearch(e,r)):g.redirect(O.searchUrl(r()))}},t._performSearch=function(e,r,n){void 0===n&&(n=A.SearchOriginPathway.WEB),re(r)||(e(t.resetTTI()),O.isFullPage(r())&&N.searchNavigationManager.set(O.searchUrl(r())),e(oe({loadingState:A.SearchLoadingState.LOADING_FIRST_PAGE})),null!==X&&clearTimeout(X),t.fetchFirstPage(e,r,n))},t.fetchFirstPage=function(e,n,s){void 0===s&&(s=A.SearchOriginPathway.WEB);var i=O.user(n()),a=O.path(n()),o=O.normalizedQuery(n()),l=O.searchType(n()),u=O.variant(n()),c=O.fileCategoriesString(n()),d=O.dateTaken(n()),g=O.selectedDimensions(n()),p=O.filteredAccountId(n()),_=K.isMediaFiltersEnabled(D.mediaFiltersVariant(n())),h=O.filteredSuggestion(n());i&&!C.skipNonValidSearchArgs(o,p,_,d,g,h)&&(e(t.stopAndLogDwellTime()),e(t.setQueryStartTime({queryStartTime:(new Date).getTime()})),M.logQueryStarted(s),ge(),F.searchApiClient.loadPartialResults(r.__assign(r.__assign({},P.apiCommonFields(n())),{start:0,includeBrowseContext:"full-page"===u,onSuccess:function(r){var s=r.searchResults,h=r.requestId,m=r.context;P.hasSearchChanged(n(),{query:o,path:a,filteredAccountId:p,searchType:l,fileCategoriesString:c,dateTaken:d,dimensions:g})||(e(t.setResults({searchResults:s,context:m,requestId:h})),Y.isTaggingEnabled(b.manualTaggingVariant(n()))&&e(G.fetchTagsForFiles({user:i,files:s.results.filter(E.isFile)})),_&&e(t.setMediaData(i,s.results.filter(Se),o)),s.hasMore||e(t.logQueryCompleted()),"full-page"===u&&(e(t.handleComponentTTI({component:"results",query:o})),e(t.startDwellTime()),e(S.resetScroll())),"full-page"===u&&s.hasMore?e(oe({loadingState:A.SearchLoadingState.LOADING_ADDITIONAL_PAGE})):e(oe({loadingState:A.SearchLoadingState.LOADED})),"full-page"===u&&(ge(),$=setTimeout((function(){P.hasSearchChanged(n(),{query:o,path:a,filteredAccountId:p,searchType:l,fileCategoriesString:c,dateTaken:d,dimensions:g})||e(t.fetchNextPage())}),L.SEARCH_SECOND_PAGE_DEBOUNCE),s.results.length&&f.initializeStore(i,s.results.filter(Se)),w.checkForMissingStarredData({items:s.results,user:i})),U.get_timer(L.SEARCH_WEB_TIMER).end())},onError:function(r){var i=(new Date).getTime()-O.queryStartTime(n());M.logQueryFailed(i,r,s),z.reportException({err:new Error(r),severity:"non-critical",tags:["js:search"]}),e(oe({loadingState:A.SearchLoadingState.LOAD_ERROR})),e(t.handleComponentTTI({component:"results",query:o}))}})))},t.resetTTI=function(){return function(e,t){e(le()),U.get_timer(L.SEARCH_WEB_TIMER).restart(),U.get_timer(L.SEARCH_WEB_TIMER).initialize({requireTTI:!0,requireTTV:!1,url:L.SEARCH_WEB_TIMER})}},t.handleComponentTTI=function(e){var t=e.component,r=e.query;return function(e,n){O.ttiComponents(n()).has(t)||k.normalize(r)===O.normalizedQuery(n())&&("results"===t&&U.get_timer(L.SEARCH_WEB_TIMER).fetchedDataRequiredForTTI(),e(ue({component:t})),O.ttiComponentsAllLoaded(n())&&U.get_timer(L.SEARCH_WEB_TIMER).markTimeToInteractive())}},t.startDwellTime=function(e){var t=(void 0===e?{startTime:Date.now()}:e).startTime;return{type:x.ActionTypes.SET_DWELL_TIME,payload:{dwellStartTime:t}}},t.stopAndLogDwellTime=function(){return function(e,r){var n=r(),s=O.dwellStartTime(n);if(void 0!==s){var i=Date.now()-s;M.logDwellTime(i,y.selectViewType(n,{instanceId:A.SEARCH_FILES_VIEW_ID})),e(t.startDwellTime({startTime:void 0}))}}},t.loadHistory=function(){return function(e,t){var r=O.user(t());if(r){var n=V.UserLocalStorage.get(r.id,A.SEARCH_RECENT_HISTORY_STORAGE_KEY)||[];e({type:x.ActionTypes.SET_QUERY_HISTORY,payload:{queryHistory:n}})}}},t.addQueryToHistory=function(){return function(e,t){var n=O.user(t());if(n){var s=O.resultQuery(t());if(s){var i=O.queryHistory(t()),a=i.indexOf(i.find((function(e){return e.rawQuery===s}))),o=r.__spreadArrays([{rawQuery:s,normalizedQuery:s}],i.filter((function(e){return e.rawQuery!==s}))).slice(0,A.SEARCH_RECENT_HISTORY_CAPACITY);e({type:x.ActionTypes.SET_QUERY_HISTORY,payload:{queryHistory:o}}),V.UserLocalStorage.set(n.id,A.SEARCH_RECENT_HISTORY_STORAGE_KEY,o),M.logHistoryAdded(a)}}}},t.clearAllHistory=function(){return function(e,t){var r=O.user(t());r&&(e({type:x.ActionTypes.SET_QUERY_HISTORY,payload:{queryHistory:[]}}),V.UserLocalStorage.delete(r.id,A.SEARCH_RECENT_HISTORY_STORAGE_KEY),M.logHistoryCleared())}},t.fetchQuerySuggestions=function(e){var n=this,s=e.query,i=e.maxResults;return function(e,a){return r.__awaiter(n,void 0,void 0,(function(){var n,o,l,u,c,d,g,p,_,h;return r.__generator(this,(function(r){switch(r.label){case 0:if(!(n=O.user(a())))return[2];if(ee=null,o=k.normalize(s),l=O.querySuggestionsCache(a())[o]){if((u=l.loadingState)===q.QuerySuggestionsLoadingState.LOADING)return[2];if(l.lastFetched&&Date.now()-l.lastFetched<A.TIME_TO_INVALIDATE_QUERY_SUGGESTIONS_CACHE){if(u===q.QuerySuggestionsLoadingState.LOADED)return e(t.setLastQueryWithQuerySuggestionsLoaded({lastQueryWithQuerySuggestionsLoaded:o})),[2];if(u===q.QuerySuggestionsLoadingState.DISMISSED)return e(ne({normalizedQuery:o,querySuggestionsData:{loadingState:q.QuerySuggestionsLoadingState.LOADED}})),e(t.setLastQueryWithQuerySuggestionsLoaded({lastQueryWithQuerySuggestionsLoaded:o})),[2]}}c=O.sessionId(a()),e(ne({normalizedQuery:o,querySuggestionsData:{suggestions:[],loadingState:q.QuerySuggestionsLoadingState.LOADING}})),d=Date.now(),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,I.getQuerySuggestions(n.id,o,i,c)];case 2:return g=r.sent().query_suggestions,e(ne({normalizedQuery:o,querySuggestionsData:{suggestions:(p=g||[]).filter((function(e){return e.text!==o})),loadingState:q.QuerySuggestionsLoadingState.LOADED,lastFetched:Date.now()}})),e(t.setLastQueryWithQuerySuggestionsLoaded({lastQueryWithQuerySuggestionsLoaded:o})),M.logQuerySuggestionsFetched(o,p.length,Date.now()-d),[3,4];case 3:return _=r.sent(),h=_.raw?new Error(_.raw.responseBody):_,z.reportException({err:h,tags:["search_bar","search_bar_query_suggestions"],severity:"non-critical"}),e(ne({normalizedQuery:o,querySuggestionsData:{loadingState:q.QuerySuggestionsLoadingState.FAILED,lastFetched:Date.now()}})),M.logQuerySuggestionsFailed(o),[3,4];case 4:return[2]}}))}))}},t.dismissQuerySuggestions=function(e){var t=e.query;return function(e,r){var n=k.normalize(t),s=O.querySuggestionsCache(r())[n];s&&s.loadingState===q.QuerySuggestionsLoadingState.LOADED&&(e(ne({normalizedQuery:n,querySuggestionsData:{loadingState:q.QuerySuggestionsLoadingState.DISMISSED}})),M.logQuerySuggestionsDismissed(t))}};var ne=function(e){var t=e.normalizedQuery,r=e.querySuggestionsData;return{type:x.ActionTypes.UPDATE_QUERY_SUGGESTIONS_CACHE,payload:{normalizedQuery:t,querySuggestionsData:r}}};t.setLastQueryWithQuerySuggestionsLoaded=function(e){var t=e.lastQueryWithQuerySuggestionsLoaded;return function(e,r){e({type:x.ActionTypes.SET_LAST_QUERY_WITH_QUERY_SUGGESTIONS_LOADED,payload:{lastQueryWithQuerySuggestionsLoaded:t}})}},t.fetchTagsSuggestions=function(e){var n=this,s=e.query;return function(e,i){return r.__awaiter(n,void 0,void 0,(function(){var n,a,o,l,u,c,d;return r.__generator(this,(function(r){if(!Y.isTaggingEnabled(b.manualTaggingVariant(i())))return[2];if(!(n=O.user(i())))return[2];if(void 0===(a=B.selectAllTagsSuggestions(i())))return e(G.fetchAllTagsSuggestions({user:n,onSuccess:function(){e(t.fetchTagsSuggestions({query:s}))}})),[2];if(o=k.normalize(s),l=O.tagsSuggestionsCache(i())[o]){if((u=l.loadingState)===q.TagsSuggestionsLoadingState.LOADING)return[2];if(u===q.TagsSuggestionsLoadingState.LOADED)return e(t.setLastQueryWithTagsSuggestionsLoaded({lastQueryWithTagsSuggestionsLoaded:o})),[2];if(u===q.TagsSuggestionsLoadingState.DISMISSED)return e(se({normalizedQuery:o,tagsSuggestionsData:{loadingState:q.TagsSuggestionsLoadingState.LOADED}})),e(t.setLastQueryWithTagsSuggestionsLoaded({lastQueryWithTagsSuggestionsLoaded:o})),[2]}e(se({normalizedQuery:o,tagsSuggestionsData:{suggestions:[],loadingState:q.TagsSuggestionsLoadingState.LOADING}}));try{7,c=j.getTagsSuggestions(o,a).slice(0,7),e(se({normalizedQuery:o,tagsSuggestionsData:{suggestions:c,loadingState:q.TagsSuggestionsLoadingState.LOADED}})),e(t.setLastQueryWithTagsSuggestionsLoaded({lastQueryWithTagsSuggestionsLoaded:o})),M.logTagSuggestionsFetched(o,c.length)}catch(t){d=t.raw?new Error(t.raw.responseBody):t,z.reportException({err:d,tags:["search_bar","search_bar_tags_suggestions"],severity:"non-critical"}),e(se({normalizedQuery:o,tagsSuggestionsData:{loadingState:q.TagsSuggestionsLoadingState.FAILED}})),M.logTagSuggestionsFailed(o)}return[2]}))}))}},t.dismissTagsSuggestions=function(e){var t=e.query;return function(e,r){if(Y.isTaggingEnabled(b.manualTaggingVariant(r()))){var n=k.normalize(t),s=O.tagsSuggestionsCache(r())[n];s&&s.loadingState===q.TagsSuggestionsLoadingState.LOADED&&(e(se({normalizedQuery:n,tagsSuggestionsData:{loadingState:q.TagsSuggestionsLoadingState.DISMISSED}})),M.logTagSuggestionsDismissed(t))}}};var se=function(e){var t=e.normalizedQuery,r=e.tagsSuggestionsData;return{type:x.ActionTypes.UPDATE_TAGS_SUGGESTIONS_CACHE,payload:{normalizedQuery:t,tagsSuggestionsData:r}}};t.setLastQueryWithTagsSuggestionsLoaded=function(e){var t=e.lastQueryWithTagsSuggestionsLoaded;return function(e,r){Y.isTaggingEnabled(b.manualTaggingVariant(r()))&&e({type:x.ActionTypes.SET_LAST_QUERY_WITH_TAGS_SUGGESTIONS_LOADED,payload:{lastQueryWithTagsSuggestionsLoaded:t}})}},t.setResults=function(e){var t=e.searchResults,r=e.requestId,n=e.context;return{type:x.ActionTypes.SET_RESULTS,payload:{searchResults:t,requestId:r,context:n}}},t.updateResults=function(e){var t=e.results;return{type:x.ActionTypes.UPDATE_RESULTS,payload:{results:t}}},t.removeResults=function(e){var t=e.results;return{type:x.ActionTypes.REMOVE_RESULTS,payload:{results:t}}},t.purgeFiles=function(n){var s=n.files,i=n.user,a=n.context;return function(n,o){return r.__awaiter(this,void 0,void 0,(function(){var o;return r.__generator(this,(function(l){switch(l.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/trash/actions"],t,r)})).then(r.__importStar)];case 1:return o=l.sent().purgeByPathBatch,u.showPurgeModal({userId:i.id,context:a,files:s,onPurge:function(){return o(i.id,s,(function(e){n(t.removeResults({results:e}))}))}}),[2]}}))}))}},t.restoreFiles=function(e){var n=e.files,s=e.user,i=e.context;return function(e,a){return r.__awaiter(this,void 0,void 0,(function(){var l;return r.__generator(this,(function(d){return l=function(n){var s=n.map((function(e){return e.fq_path})),i=O.results(a()).reduce((function(e,t){return E.isFile(t)&&s.includes(t.fq_path)?r.__spreadArrays(e,[new m.File(r.__assign(r.__assign({},t),{isDeleted:!1}))]):e}),[]);e(t.updateResults({results:i}))},u.showUnifiedTrashModal({userId:s.id,context:i,files:n,onRestore:function(e,t){c.restoreFiles({files:t,userId:s.id,onSuccess:function(){o.notifyRestoreSuccess(t),l(t)},isSearchMode:!1})}}),[2]}))}))}};var ie=function(){return{type:x.ActionTypes.CLEAR_RESULTS}},ae=function(e){var t=e.searchResults,r=e.loadingState;return{type:x.ActionTypes.APPEND_RESULTS,payload:{searchResults:t,loadingState:r}}},oe=function(e){var t=e.loadingState;return{type:x.ActionTypes.SET_LOADING_STATE,payload:{loadingState:t}}},le=function(){return{type:x.ActionTypes.CLEAR_TTI_COMPONENTS}},ue=function(e){var t=e.component;return{type:x.ActionTypes.ADD_TTI_COMPONENT,payload:{component:t}}},ce=function(e){var t=e.normalizedQuery,r=e.peopleSuggestionsData;return{type:x.ActionTypes.UPDATE_PEOPLE_SUGGESTIONS_CACHE,payload:{normalizedQuery:t,peopleSuggestionsData:r}}},de=function(e){var t=e.lastQueryWithPeopleSuggestionsLoaded;return{type:x.ActionTypes.SET_LAST_QUERY_WITH_PEOPLE_SUGGESTIONS_LOADED,payload:{lastQueryWithPeopleSuggestionsLoaded:t}}};t.setHighlightedRow=function(e){var t=e.index;return{type:x.ActionTypes.SET_HIGHLIGHTED_ROW,payload:{index:t}}},t.setQueryStartTime=function(e){var t=e.queryStartTime;return{type:x.ActionTypes.SET_QUERY_START_TIME,payload:{queryStartTime:t}}},t.logQueryCompleted=function(){return function(e,n){var s;return r.__awaiter(this,void 0,void 0,(function(){var i,a,o,l;return r.__generator(this,(function(r){return(i=O.queryStartTime(n()))&&(a=K.isMediaMetadataSearchEnabled(b.mediaFiltersVariant(n())),Y.isTaggingEnabled(b.manualTaggingVariant(n()))?(o=O.query(n()),l=(null!==(s=o.match(/(^|\s)#/g))&&void 0!==s?s:[]).length,M.logQueryCompleted((new Date).getTime()-i,a,l,"search bar")):M.logQueryCompleted((new Date).getTime()-i,a),e(t.setQueryStartTime({queryStartTime:void 0}))),[2]}))}))}};var ge=function(){X=pe(X),$=pe($)},pe=function(e){return null!==e&&clearTimeout(e),null},_e=function(e){switch(e){case p.SEARCH_ORDER_BY_TYPE.LAST_MODIFIED_TIME:return v.SortField.MODIFIED;case p.SEARCH_ORDER_BY_TYPE.RELEVANCE:default:return v.SortField.RELEVANCE}},he=function(e){switch(e){case A.SearchOriginPathway.ASSISTANT:return A.SearchOriginPathway.ASSISTANT;case A.SearchOriginPathway.COLLAB_BROWSE:return A.SearchOriginPathway.COLLAB_BROWSE;default:return A.SearchOriginPathway.WEB}},me=function(e){switch(e){case p.SEARCH_REVERSE_ORDER_TYPE.TRUE:return v.SortDirection.ASCENDING;case p.SEARCH_REVERSE_ORDER_TYPE.FALSE:default:return v.SortDirection.DESCENDING}},fe=function(e,t){return!e&&!t||!(!e||!t)&&(e.sortField===t.sortField&&e.sortDirection===t.sortDirection)};t.setFilters=function(e){var r=e.path,n=e.fileCategories,s=e.searchType,i=e.filteredAccountId,a=e.dateTaken,o=e.selectedDimensions;return function(e,u){r&&!l.paths_are_equal(r,O.path(u()))&&e(t.setPath({path:r,viewport:"view"})),n&&e(t.setFileCategories({fileCategories:n})),s&&e(t.setSearchType({searchType:s})),null===i&&e(t.setFilteredAccountId({filteredAccountId:void 0})),void 0!==a&&e(t.setDateTaken({dateTaken:a})),void 0!==o&&e(t.setSelectedDimensions({selectedDimensions:o}))}},t.resetFilters=function(){return function(e){e(t.setFilters({path:"/",fileCategories:A.FILE_CATEGORIES_UNCHECKED,filteredAccountId:null,dateTaken:q.DateTaken.Any,selectedDimensions:[]})),M.logFiltersReset()}};var Se=function(e){return e instanceof m.File};t.shouldStartNewSearchSession=function(e,t){var r=t.query;return!O.sessionId(e)||(!(!O.normalizedQuery(e)||r)||O.normalizedQuery(e).length>=3&&1===r.length)};var ye=function(e,t,n){return r.__awaiter(void 0,void 0,void 0,(function(){var s,i,a,o;return r.__generator(this,(function(r){return n&&0!==n.selected.count()?(s=O.results(t()),i=null==s?void 0:s.filter((function(e){return E.isFile(e)&&n.selected.has(e.fq_path)&&!e.thumbnail_url_tmpl})),a=[],null==i||i.forEach((function(e){E.isFile(e)&&a.push({file_id:e.file_id,sj_id:e.sjid,ns_id:e.ns_id})})),a.length>0&&(o=O.user(t()))&&e(S.loadPreviewThumbnails(a,o.id,A.SEARCH_FILES_VIEW_ID)),[2]):[2]}))}))};t.handleNavigateToFileOrFolder=function(e,r){return void 0===r&&(r={}),function(o,l){var u=r.actionSource,c=O.user(l()),g=O.context(l()),p=O.resultsList(l());if(o(t.addQueryToHistory()),o(t.stopAndLogDwellTime()),e instanceof m.FileSharedWithMe)return M.logResultAction(W.WebUserActionLogEvent.FILE_VIEW,p,e),void d.redirect(e.href);if(e.isDeleted)o(t.restoreFiles({files:[e],user:c,context:g}));else{if(e.is_dir)return M.logResultAction(W.WebUserActionLogEvent.FOLDER_OPEN,p,e,void 0,u),void N.searchNavigationManager.set(n.href_for_file(c,e));if(M.logResultAction(W.WebUserActionLogEvent.FILE_VIEW,p,e,void 0,u),e.is_cloud_doc)s.openCloudDoc(e,c,a.WebSearchSource);else if(i.hasPreferredEditorSupport(e)){var _=O.preferredEditors(l());i.openInPreferredEditor(c,e,_,(function(){o(t.setPreviewFile({previewFileId:e.file_id}))}),{fileViewAction:H.FileViewActionType.CLICK,fileViewOrigin:H.FileViewOriginType.SEARCH})}else o(t.setPreviewFile({previewFileId:e.file_id}))}}}})),define("modules/clean/search/single_page/data/action_creators/file_actions",["require","exports","tslib","lodash","immutable","modules/clean/file_actions/metrics","modules/clean/file_actions/strings","modules/clean/metrics/index","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/action_logger","modules/clean/react/browse/logger_util","modules/clean/react/browse/models","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/file_actions/api_v2","modules/clean/react/files_view/file_actions/file_from_metadata","modules/clean/react/files_view/file_actions/rollback","modules/clean/react/files_view/file_actions/snackbars","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/react/selection","modules/clean/react/snackbar","modules/clean/search/constants","modules/clean/search/single_page/data/action_creators/index","modules/clean/search/single_page/data/selectors/index","modules/clean/tagging/data/action_creators","modules/clean/undo","modules/clean/web_user_action_events","modules/core/i18n","modules/core/exception"],(function(e,t,r,n,s,i,a,o,l,u,c,d,g,p,_,h,m,f,S,y,v,E,T,w,F,C,A,R,I,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renameFile=t.renameUndo=t.deleteFiles=t.setIsDeletedOnPathsInResults=void 0,s=r.__importStar(s),l=r.__importStar(l),c=r.__importStar(c),g=r.__importStar(g),p=r.__importStar(p),_=r.__importStar(_),f=r.__importStar(f),F=r.__importStar(F);var b=function(e){var t=e.state,r=e.eventName,n=e.num_files_selected,s=e.num_folders_selected,i=e.batch_success_count,a=e.batch_fail_count,o=e.lookup_error_type,l=e.error_summary;u.logFileAction({uid:F.user(t).id,action:r,num_files_selected:n,num_folders_selected:s,view_type:p.selectViewType(t,{instanceId:T.SEARCH_FILES_VIEW_ID}),batch_success_count:i,batch_fail_count:a,lookup_error_type:o,error_summary:l})};t.setIsDeletedOnPathsInResults=function(e,t,s){return n.compact(s.toArray().map((function(n){if(y.isFile(n)&&t.includes(n.fq_path))return new d.File(r.__assign(r.__assign({},n),{isDeleted:e,thumbnail_url_tmpl:e?null:n.thumbnail_url_tmpl}))})))};function D(e){var t=e.files,n=e.user,s=e.context;return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){return[2,new Promise((function(e){l.showDelete(n,t,s,"/",e)}))]}))}))}t.deleteFiles=function(e){var n=e.files,s=e.checkFSWs;return function(e,u){return r.__awaiter(this,void 0,void 0,(function(){var d,g,p,h,S,y,v,T,C,L,P,O,x,M,N,Q,k,q,V,U=this;return r.__generator(this,(function(W){switch(W.label){case 0:return d=F.user(u()),g=F.context(u()),[4,D({user:d,files:n,context:g})];case 1:return W.sent(),p=o.getMetricsReporter(),h={surface:"search",batchSizeBucket:i.bucketForBatchSize(n.length),contentType:i.batchContentType(n)},S=p.createTimer({ns:i.FILE_ACTIONS_AMP_NAMESPACE,name:"delete/batch/latency_total_ms"},h),y=Date.now(),v=p.createStats({ns:i.FILE_ACTIONS_AMP_NAMESPACE,name:"delete/batch/latency_average_ms"},h),T=p.createStats({ns:i.FILE_ACTIONS_AMP_NAMESPACE,name:"delete/batch/completed"},h),E.Snackbar.sync(I.intl.formatMessage(a.deleteSnackbarProgressMessage,{count:n.length}),!0,"browse-action"),b({state:u(),eventName:R.WebUserActionLogEvent.DELETE_REQUEST_ATTEMPT,num_files_selected:n.length,num_folders_selected:0}),[4,_.deleteFiles(n,d.id,s)];case 2:return(C=W.sent()).isError&&"path"===C.error[".tag"]&&"file_system_warnings"===C.error.path[".tag"]?(e((function(e){var n=e.files,s=e.details;return function(e,i){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(r){return E.Snackbar.close("browse-action"),l.showFileSystemWarningsModal({fsws:s,onFinalAccept:function(){e(t.deleteFiles({files:n,checkFSWs:!1}))},confirmText:I.intl.formatMessage(a.deleteFswConfirmText)}),[2]}))}))}})({files:n,details:C.error.path.details})),[2]):(S.record(),v.record((Date.now()-y)/n.length),C.isError?(e((function(e){var t=e.files,n=e.result;return function(e,s){return r.__awaiter(void 0,void 0,void 0,(function(){var e,i,a,o;return r.__generator(this,(function(r){return E.Snackbar.fail(f.deleteError(t.length,n.error),"browse-action"),e=F.selectedFiles(s()),i=c.countFilesAndFolders(e),a=i.num_files_selected,o=i.num_folders_selected,b({state:s(),eventName:R.WebUserActionLogEvent.DELETE_REQUEST_FAIL,num_files_selected:a,num_folders_selected:o,batch_success_count:0,batch_fail_count:t.length,error_summary:n.error_summary}),[2]}))}))}})({files:n,result:C})),T.record(0),[2]):(L=function(e){return"success"===e[".tag"]},P=C.result.entries.filter(L),O=P.map((function(e){return e.metadata.path_display})),e(w.updateResults({results:t.setIsDeletedOnPathsInResults(!0,O,F.results(u()))})),x=function(){return r.__awaiter(U,void 0,void 0,(function(){return r.__generator(this,(function(r){return E.Snackbar.close("browse-action"),b({state:u(),eventName:R.WebUserActionLogEvent.DELETE_UNDO,num_files_selected:C.result.changeset_data.length,num_folders_selected:0}),m.rollback({changeset_data:C.result.changeset_data,userId:d.id,onSuccess:function(){E.Snackbar.complete(I.intl.formatMessage(a.deleteUndoSnackbarMessage),"browse-action"),b({state:u(),eventName:R.WebUserActionLogEvent.DELETE_UNDO_REQUEST_SUCCESS,num_files_selected:C.result.changeset_data.length,num_folders_selected:0}),e(w.updateResults({results:t.setIsDeletedOnPathsInResults(!1,O,F.results(u()))}))}}),[2]}))}))},A.setHandleUndo(x),M=C.result.entries.filter(_.isFailure),void 0!==(N=M[0])&&(q=N.failure,Q=q[".tag"],_.isPathLookupFailure(q)&&(k=q.path_lookup[".tag"])),V=C.result.entries.filter((function(e){return _.isFailure(e)&&!_.isPathLookupFailure(e.failure)})).length,T.record(V>0?0:1),i.recordPathLookupErrors(M,"delete",h),M.length===C.result.entries.length?(E.Snackbar.fail(f.deleteCompleteError(M),"browse-action"),b({state:u(),eventName:R.WebUserActionLogEvent.DELETE_REQUEST_FAIL,num_files_selected:C.result.changeset_data.length,num_folders_selected:0,batch_success_count:C.result.entries.length-M.length,batch_fail_count:M.length,lookup_error_type:k,error_summary:Q})):(E.Snackbar.completeWithUndo(f.deleteCompleteSuccess(n.length,P.length),x,"browse-action"),b({state:u(),eventName:R.WebUserActionLogEvent.DELETE_REQUEST_SUCCESS,num_files_selected:C.result.changeset_data.length,num_folders_selected:0,batch_success_count:C.result.entries.length,batch_fail_count:0,lookup_error_type:k,error_summary:Q})),[2]))}}))}))}};t.renameUndo=function(e){var t=e.file,n=e.result;return function(e,l){return r.__awaiter(void 0,void 0,void 0,(function(){var u,c,d,g;return r.__generator(this,(function(r){switch(r.label){case 0:return u=F.user(l()),c=o.getMetricsReporter(),d={surface:"search",contentType:t.is_dir?"folders":"files",batchSizeBucket:"single"},g={latency:c.createTimer({ns:i.FILE_ACTIONS_AMP_NAMESPACE,name:"undo/latency_ms"},d),completed:c.createStats({ns:i.FILE_ACTIONS_AMP_NAMESPACE,name:"undo/completed"},d)},E.Snackbar.sync(I.intl.formatMessage(a.renameUndoSnackbarProgressMessage),!1,"browse-action"),[4,_.undo(n.result.changeset_data,u)];case 1:return r.sent().isError?(E.Snackbar.fail(I.intl.formatMessage(a.renameUndoSnackbarErrorMessage),"browse-action"),g.completed.record(0)):(E.Snackbar.complete(I.intl.formatMessage(a.renameUndoSnackbarSuccessMessage),"browse-action"),e(w.updateResults({results:[t]})),e(w.setSelection({selection:new v.Selection({selected:s.OrderedSet([t.fq_path]),anchor:null}),skipLogging:!0})),g.completed.record(1)),g.latency.record(),[2]}}))}))}},t.renameFile=function(e){var n=e.file,u=e.name,c=e.checkFSWs;return function(e,d){return r.__awaiter(this,void 0,void 0,(function(){var p,m,y,T,R,b,D,P,O;return r.__generator(this,(function(x){switch(x.label){case 0:return p=F.user(d()),m=o.getMetricsReporter(),y={surface:"browse",contentType:n.is_dir?"folders":"files"},T={latency:m.createTimer({ns:i.FILE_ACTIONS_AMP_NAMESPACE,name:"rename/latency_ms"},y),completed:m.createStats({ns:i.FILE_ACTIONS_AMP_NAMESPACE,name:"rename/completed"},y)},-1!==u.indexOf("/")?(E.Snackbar.fail(I.intl.formatMessage(a.renameErrorInvalidName),"browse-action"),e(g.setFileRename({file:n,renameState:null})),[2]):(e(g.setFileRename({file:n,renameState:S.RenameState.SAVING_INPUT})),E.Snackbar.sync(I.intl.formatMessage(a.renameSnackbarProgressMessage),!1,"browse-action"),[4,_.renameFile(n.fq_path,u,p.id,c)]);case 1:return(R=x.sent()).isError&&"to"===R.error[".tag"]&&"file_system_warnings"===R.error.to[".tag"]?(e((function(e){var n=e.file,s=e.name,i=e.details;return function(e){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(r){return E.Snackbar.close("browse-action"),l.showFileSystemWarningsModal({fsws:i,onFinalAccept:function(){e(t.renameFile({file:n,name:s,checkFSWs:!1}))},onAbortAction:function(){e(g.setFileRename({file:n,renameState:null}))},confirmText:I.intl.formatMessage(a.renameFswConfirmText)}),[2]}))}))}})({file:n,name:u,details:R.error.to.details})),[2]):(T.latency.record(),R.isError||"success"!==R.result.entries[0][".tag"]?(L.reportStack("Unsuccessful result from rename file client",{severity:L.SEVERITY.NON_CRITICAL,exc_extra:{result:R},tags:[_.EXCLOG_TAG]}),b=R.isError?R:_.createUndefinedRpcResult(),e((function(e){var t=e.file,n=e.result;return function(e,s){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(r){return e(g.setFileRename({file:t,renameState:null})),E.Snackbar.fail(f.renameError(n.error,t.fq_path),"browse-action"),[2]}))}))}})({file:n,result:b})),T.completed.record(0),[2]):(D=R.result.entries[0],P=h.fileFromMetadata(n,D.success),e(w.updateResults({results:[P]})),e(w.setSelection({selection:new v.Selection({selected:s.OrderedSet([P.fq_path]),anchor:null}),skipLogging:!0})),e(C.fileRename({file:n,newFile:P})),e(g.setFileRename({file:n,renameState:null})),T.completed.record(1),O=function(){e(t.renameUndo({file:n,result:R}))},A.setHandleUndo(O),E.Snackbar.completeWithUndo(I.intl.formatMessage(a.renameSnackbarSuccessMessage),O,"browse-action"),[2]))}}))}))}}})),define("modules/clean/search/single_page/data/reducer",["require","exports","tslib","immutable","modules/clean/react/browse/models","modules/clean/react/files_view/sort_types","modules/clean/react/selection","modules/clean/search/constants","modules/clean/search/single_page/data/types","modules/clean/search/single_page/utils","modules/clean/search/store_helpers","modules/clean/search/types"],(function(e,t,r,n,s,i,a,o,l,u,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.searchReducer=t.defaultSearchState=void 0,n=r.__importStar(n),t.defaultSearchState={variant:"full-page",loadingState:o.SearchLoadingState.ZERO_QUERY,results:n.OrderedMap(),query:"",resultQuery:"",path:"/",sessionId:"",selection:a.createSelection(),queryHistory:[],previewFileId:void 0,sortOrder:{sortField:i.SortField.RELEVANCE,sortDirection:i.SortDirection.DESCENDING},fileCategories:o.FILE_CATEGORIES_UNCHECKED,context:new s.BrowseContext,ttiComponents:n.Set(),searchType:o.SearchType.ALL,imageSuggestionCount:0,imageSuggestionQuery:"",imageSuggestionRequestId:void 0,imageSuggestionResults:n.OrderedMap(),filteredAccountId:void 0,peopleSuggestionsCache:{},lastQueryWithPeopleSuggestionsLoaded:void 0,querySuggestionsCache:{},spellCorrection:void 0,isCreatingSharedLinkMap:n.Map(),tagsSuggestionsCache:{},selectedDimensions:[],dateTaken:d.DateTaken.Any,mediaData:{},popularFiltersCache:{},filteredSuggestion:void 0};var g=function(e){return r.__assign(r.__assign({},e),{results:e.results.clear(),resultQuery:"",hasMoreResults:!0,selection:a.createSelection(),imageSuggestionCount:0,imageSuggestionQuery:"",imageSuggestionRequestId:void 0,spellCorrection:void 0})},p=function(e,t){return r.__assign(r.__assign({},e),{results:e.results.concat(t.searchResults.results.map((function(e){return[u.getIdForSearchResult(e),e]}))),cursor:t.searchResults.cursor,resultQuery:c.normalize(e.query),hasMoreResults:t.searchResults.hasMore,loadingState:t.loadingState||e.loadingState})},_=function(e,t){return r.__assign(r.__assign({},e),{spellCorrection:t.searchResults.spellCorrection})},h=function(e,t){return r.__assign(r.__assign({},e),{requestId:t.requestId})};t.searchReducer=function(e,s){switch(void 0===e&&(e=t.defaultSearchState),s.type){case l.ActionTypes.SET_VARIANT:return(function(e,t){return r.__assign(r.__assign({},e),{variant:t.variant})})(e,s.payload);case l.ActionTypes.SET_USER:return(function(e,t){return r.__assign(r.__assign({},e),{user:t.user,userOptions:t.options})})(e,s.payload);case l.ActionTypes.SET_EXPERIMENTS:return(function(e,t){return r.__assign(r.__assign({},e),{experiments:t.experiments})})(e,s.payload);case l.ActionTypes.SET_PATH:return(function(e,t){return r.__assign(r.__assign({},e),{path:t.path})})(e,s.payload);case l.ActionTypes.SET_FILE_CATEGORIES:return(function(e,t){return r.__assign(r.__assign({},e),{fileCategories:t.fileCategories})})(e,s.payload);case l.ActionTypes.SET_LOADING_STATE:return(function(e,t){return r.__assign(r.__assign({},e),{loadingState:t.loadingState})})(e,s.payload);case l.ActionTypes.SET_QUERY:return(function(e,t){return r.__assign(r.__assign({},e),{query:t.query,highlightedRow:void 0})})(e,s.payload);case l.ActionTypes.SET_RESULTS:return(function(e,t){var n=t.searchResults,s=t.requestId,i=t.context,a=r.__assign(r.__assign({},e),{context:i||e.context});return a=g(a),a=p(a,{searchResults:n}),a=h(a,{requestId:s}),a=_(a,{searchResults:n})})(e,s.payload);case l.ActionTypes.CLEAR_RESULTS:return g(e);case l.ActionTypes.APPEND_RESULTS:return p(e,s.payload);case l.ActionTypes.SET_SESSION_ID:return(function(e,t){return r.__assign(r.__assign({},e),{sessionId:t.sessionId})})(e,s.payload);case l.ActionTypes.SET_REQUEST_ID:return h(e,s.payload);case l.ActionTypes.SET_SELECTION:return(function(e,t){return r.__assign(r.__assign({},e),{selection:t.selection})})(e,s.payload);case l.ActionTypes.SET_PREVIEW_FILE_ID:return(function(e,t){return r.__assign(r.__assign({},e),{previewFileId:t.previewFileId})})(e,s.payload);case l.ActionTypes.SET_PREVIEW_COMMENTS_THREAD_ID:return(function(e,t){return r.__assign(r.__assign({},e),{previewCommentsThreadId:t.previewCommentsThreadId})})(e,s.payload);case l.ActionTypes.SET_SORT_ORDER:return(function(e,t){return r.__assign(r.__assign({},e),{sortOrder:t.sortOrder})})(e,s.payload);case l.ActionTypes.ADD_TTI_COMPONENT:return(function(e,t){return r.__assign(r.__assign({},e),{ttiComponents:e.ttiComponents.add(t.component)})})(e,s.payload);case l.ActionTypes.CLEAR_TTI_COMPONENTS:return(function(e){return r.__assign(r.__assign({},e),{ttiComponents:n.Set()})})(e);case l.ActionTypes.SET_SEARCH_TYPE:return(function(e,t){return r.__assign(r.__assign({},e),{searchType:t.searchType})})(e,s.payload);case l.ActionTypes.SET_IMAGE_SUGGESTION:return(function(e,t){var n=e.imageSuggestionResults.clear();return r.__assign(r.__assign({},e),{imageSuggestionResults:n.concat(t.results.map((function(e){return[u.getIdForSearchResult(e),e]}))),imageSuggestionCount:t.results.length,imageSuggestionQuery:t.query,imageSuggestionRequestId:t.requestId})})(e,s.payload);case l.ActionTypes.SET_DWELL_TIME:return(function(e,t){return r.__assign(r.__assign({},e),{dwellStartTime:t.dwellStartTime})})(e,s.payload);case l.ActionTypes.UPDATE_RESULTS:return(function(e,t){var n=e.results.map((function(e){var r=t.results.find((function(t){return u.getIdForSearchResult(e)===u.getIdForSearchResult(t)}));return void 0===r?e:r}));return r.__assign(r.__assign({},e),{results:n})})(e,s.payload);case l.ActionTypes.REMOVE_RESULTS:return(function(e,t){var n=t.results.map((function(e){return u.getIdForSearchResult(e)})),s=e.results.filter((function(e){return!n.includes(u.getIdForSearchResult(e))}));return r.__assign(r.__assign({},e),{results:s})})(e,s.payload);case l.ActionTypes.SET_QUERY_HISTORY:return(function(e,t){var n=t.queryHistory;return r.__assign(r.__assign({},e),{queryHistory:n})})(e,s.payload);case l.ActionTypes.SET_HIGHLIGHTED_ROW:return(function(e,t){return r.__assign(r.__assign({},e),{highlightedRow:t.index})})(e,s.payload);case l.ActionTypes.UPDATE_QUERY_SUGGESTIONS_CACHE:return(function(e,t){var n,s=t.normalizedQuery,i=t.querySuggestionsData;return r.__assign(r.__assign({},e),{querySuggestionsCache:r.__assign(r.__assign({},e.querySuggestionsCache),(n={},n[s]=r.__assign(r.__assign({},e.querySuggestionsCache[s]),i),n))})})(e,s.payload);case l.ActionTypes.SET_LAST_QUERY_WITH_QUERY_SUGGESTIONS_LOADED:return(function(e,t){var n=t.lastQueryWithQuerySuggestionsLoaded;return r.__assign(r.__assign({},e),{lastQueryWithQuerySuggestionsLoaded:n})})(e,s.payload);case l.ActionTypes.SET_FILTERED_ACCOUNT_ID:return(function(e,t){return r.__assign(r.__assign({},e),{filteredAccountId:t.filteredAccountId})})(e,s.payload);case l.ActionTypes.UPDATE_PEOPLE_SUGGESTIONS_CACHE:return(function(e,t){var n,s=t.normalizedQuery,i=t.peopleSuggestionsData;return r.__assign(r.__assign({},e),{peopleSuggestionsCache:r.__assign(r.__assign({},e.peopleSuggestionsCache),(n={},n[s]=r.__assign(r.__assign({},e.peopleSuggestionsCache[s]),i),n))})})(e,s.payload);case l.ActionTypes.SET_LAST_QUERY_WITH_PEOPLE_SUGGESTIONS_LOADED:return(function(e,t){return r.__assign(r.__assign({},e),{lastQueryWithPeopleSuggestionsLoaded:t.lastQueryWithPeopleSuggestionsLoaded})})(e,s.payload);case l.ActionTypes.SET_QUERY_START_TIME:return(function(e,t){return r.__assign(r.__assign({},e),{queryStartTime:t.queryStartTime})})(e,s.payload);case l.ActionTypes.SET_IS_CREATING_SHARED_LINK:return(function(e,t){return r.__assign(r.__assign({},e),{isCreatingSharedLinkMap:e.isCreatingSharedLinkMap.set(t.payload.fileIdOrPath,t.payload.isCreatingSharedLink)})})(e,s);case l.ActionTypes.UPDATE_TAGS_SUGGESTIONS_CACHE:return(function(e,t){var n,s=t.normalizedQuery,i=t.tagsSuggestionsData;return r.__assign(r.__assign({},e),{tagsSuggestionsCache:r.__assign(r.__assign({},e.tagsSuggestionsCache),(n={},n[s]=r.__assign(r.__assign({},e.tagsSuggestionsCache[s]),i),n))})})(e,s.payload);case l.ActionTypes.SET_LAST_QUERY_WITH_TAGS_SUGGESTIONS_LOADED:return(function(e,t){var n=t.lastQueryWithTagsSuggestionsLoaded;return r.__assign(r.__assign({},e),{lastQueryWithTagsSuggestionsLoaded:n})})(e,s.payload);case l.ActionTypes.SET_DATE_TAKEN:return(function(e,t){var n=t.dateTaken;return r.__assign(r.__assign({},e),{dateTaken:n})})(e,s.payload);case l.ActionTypes.SET_SELECTED_DIMENSIONS:return(function(e,t){var n=t.selectedDimensions;return r.__assign(r.__assign({},e),{selectedDimensions:n})})(e,s.payload);case l.ActionTypes.SET_MEDIA_DATA:return(function(e,t){var n=t.filesMediaData,s={};return n.forEach((function(e){void 0!==e.file_id_or_path&&(s[e.file_id_or_path]=e)})),e.mediaData&&Object.values(e.mediaData).forEach((function(e){void 0!==e.file_id_or_path&&(s[e.file_id_or_path]=e)})),r.__assign(r.__assign({},e),{mediaData:s})})(e,s.payload);case l.ActionTypes.UPDATE_POPULAR_FILTERS_CACHE:return(function(e,t){var n,s=t.normalizedQuery,i=t.popularFiltersData;return r.__assign(r.__assign({},e),{popularFiltersCache:r.__assign(r.__assign({},e.popularFiltersCache),(n={},n[s]=r.__assign(r.__assign({},e.popularFiltersCache[s]),i),n))})})(e,s.payload);case l.ActionTypes.SET_LAST_QUERY_WITH_POPULAR_FILTERS_LOADED:return(function(e,t){var n=t.lastQueryWithPopularFiltersLoaded;return r.__assign(r.__assign({},e),{lastQueryWithPopularFiltersLoaded:n})})(e,s.payload);case l.ActionTypes.SET_FILTERED_SEARCH_SUGGESTION:return(function(e,t){return r.__assign(r.__assign({},e),{filteredSuggestion:{type:t.type,query:t.query}})})(e,s.payload);default:return e}}})),define("modules/clean/search/single_page/data/selectors/experiments",["require","exports","tslib","reselect","dropbox/proto/js_init_data/browse_web/browse_web","modules/clean/react/browse/models","modules/clean/redux/namespaces","modules/clean/redux/selectors","modules/clean/search/constants","modules/clean/search/single_page/constants","modules/clean/search/single_page/data/selectors/index","modules/core/i18n","modules/clean/media_filters/gating"],(function(e,t,r,n,s,i,a,o,l,u,c,d,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.searchDocClassificationVariant=t.autoTagAwarenessVariant=t.flowsAutoTagUiVariant=t.flowsAutomatedFolderUiVariant=t.manualTaggingVariant=t.actionBarExperimentSelector=t.maxResultsToFetch=t.shouldRenderInlineSearchFilters=t.isEmptyStateExperiment=t.searchEmptyStateVariant=t.mediaFiltersVariant=t.shouldShowFolderOverview=t.shouldShowSelectionPreviewPane=t.shouldRenderEmptyZeroQueryView=t.shouldRenderHistory=t.shouldRenderTabs=t.tabs=t.isSearchAsYouTypeEnabled=t.browseExperiments=t.searchResultsExperiments=t.experiments=void 0,c=r.__importStar(c);t.experiments=function(e){return(function(e){return o.getStateAtNamespace(e,a.SEARCH_NAMESPACE_KEY)})(e).experiments||{}};var p=function(e,t){return!!e&&!0===e[t]};t.searchResultsExperiments=n.createSelector(t.experiments,(function(e){return{expImageContentSearch:p(e,"search_image_content"),expManualTagging:e.manual_tagging,expFlowsAutomatedFolderUI:e.flows_automated_folder_ui,expFlowsAutoTagUi:e.flows_auto_tag_ui,expAutoTagAwareness:e.auto_tag_awareness}})),t.browseExperiments=n.createSelector(t.experiments,(function(e){return s.browse_web.BrowseExperiments.create({folderHistoryRollbacks:p(e,"folder_history_rollbacks")})})),t.isSearchAsYouTypeEnabled=n.createSelector(t.experiments,c.isFullPage,(function(e,t){return!t||"ON"!==e.search_experiment_disable_sayt&&"ON_WITH_SUGGESTIONS"!==e.search_experiment_disable_sayt})),t.tabs=n.createSelector(t.experiments,(function(e){return e.search_image_content?[{id:l.SearchType.ALL,label:d.intl.formatMessage({id:"yKk1zB",defaultMessage:"Text"})},{id:l.SearchType.IMAGE,label:d.intl.formatMessage({id:"lJEvbU",defaultMessage:"Images"})}]:void 0})),t.shouldRenderTabs=n.createSelector(t.tabs,(function(e){return!(!e||!e.length)})),t.shouldRenderHistory=n.createSelector(c.loadingState,c.queryHistory,(function(e,t){return e===l.SearchLoadingState.ZERO_QUERY&&0!==t.length})),t.shouldRenderEmptyZeroQueryView=n.createSelector(t.shouldRenderHistory,(function(e){return!e}));var _=function(e,t){var r=t.responsive;return!(!r||!r.isResponsive||r.isMatchedLarge)};t.shouldShowSelectionPreviewPane=n.createSelector(_,c.numResults,(function(e,t){return!(e||!(t>0))})),t.shouldShowFolderOverview=n.createSelector(_,c.selectedFiles,(function(e,t){return!e&&1===t.size&&t.first().is_dir&&!i.File.isNoAccessSharedFolder(t.first())})),t.mediaFiltersVariant=n.createSelector(t.experiments,(function(e){return e.media_filters||"OFF"})),t.searchEmptyStateVariant=n.createSelector(t.experiments,(function(e){return e.search_empty_state||"OFF"})),t.isEmptyStateExperiment=function(e){return!!e&&["V1"].includes(e)},t.shouldRenderInlineSearchFilters=n.createSelector(c.hasResultQuery,c.filteredAccountId,t.mediaFiltersVariant,(function(e,t,r){return Boolean(e||t||g.isMediaFiltersEnabled(r))})),t.maxResultsToFetch=n.createSelector(c.variant,c.nextPageOffset,t.isSearchAsYouTypeEnabled,(function(e,t,r){return t?u.SEARCH_ADDITIONAL_PAGE_SIZE:"dropdown"===e?u.SEARCH_DROPDOWN_PAGE_SIZE:r?u.SEARCH_FIRST_PAGE_SIZE:u.SEARCH_ADDITIONAL_PAGE_SIZE})),t.actionBarExperimentSelector=n.createSelector(t.experiments,(function(e){return{expVaultEnableViewOnlySharing:!1,expSpacesFssDropdown:!1,expShowTransferInShare:!1,expBrowseRightRail:e.browse_right_rail||"OFF",expManualPdfConversion:Boolean(e.manual_pdf_conversion),expFlowsFileConversionUI:!1,expFlowsAutomatedFolderUI:!1,expActionBarRedesign:e.browse_action_bar_redesign||"OFF",expFlowsManualVideoRemuxUi:!1,expFlowsManualVideoGifUi:!1,expFssEntryPointForSpaces:!1,expPgEsignDiscoveryFileHover:Boolean(e.pg_esign_discovery_file_hover),expSynchronousSingleFileActions:!1,expBrowseBoostSharing:"OFF",expEnableSharingNSF:Boolean(e.nsf_web_enabled),expMultiObjectSharingRedesign:e.multi_object_sharing_redesign_exp||"OFF",expFlowsAudioConversionUi:!1}})),t.manualTaggingVariant=n.createSelector(t.experiments,(function(e){return e.manual_tagging||"OFF"})),t.flowsAutomatedFolderUiVariant=n.createSelector(t.experiments,(function(e){return e.flows_automated_folder_ui||!1})),t.flowsAutoTagUiVariant=n.createSelector(t.experiments,(function(e){return e.flows_auto_tag_ui||!1})),t.autoTagAwarenessVariant=n.createSelector(t.experiments,(function(e){return e.auto_tag_awareness||!1})),t.searchDocClassificationVariant=n.createSelector(t.experiments,(function(e){return e.search_doc_classification||"OFF"}))})),define("modules/clean/search/single_page/data/selectors/index",["require","exports","tslib","immutable","reselect","modules/clean/filepath/filepath","modules/clean/react/browse/constants","modules/clean/react/browse/models","modules/clean/react/browse/uri_helper","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/sort_types","modules/clean/redux/namespaces","modules/clean/redux/selectors","modules/clean/search/api_helpers","modules/clean/search/constants","modules/clean/search/search_helpers","modules/clean/search/single_page/navigation","modules/clean/search/single_page/utils","modules/clean/search/store_helpers","modules/clean/search/types","modules/core/i18n","modules/clean/react/files_view/constants","modules/clean/tagging/utils","modules/clean/tagging/data/selectors/index","modules/clean/tagging/experiments"],(function(e,t,r,n,s,i,a,o,l,u,c,d,g,p,_,h,m,f,S,y,v,E,T,w,F){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPage=t.browseCommentsEnabled=t.showViewModeToggle=t.selectResultById=t.highlightedSuggestion=t.suggestions=t.popularFiltersLoadingState=t.popularFilters=t.lastQueryWithPopularFiltersLoaded=t.popularFiltersCache=t.tagsSuggestionsLoadingState=t.tagsSuggestions=t.lastQueryWithTagsSuggestionsLoaded=t.tagsSuggestionsCache=t.peopleSuggestionsLoadingState=t.peopleSuggestions=t.filteredContactName=t.filteredContact=t.querySuggestionsLoadingState=t.querySuggestions=t.lastQueryWithQuerySuggestionsLoaded=t.querySuggestionsCache=t.hasFiltersSelected=t.ttiComponentsAllLoaded=t.previewableFiles=t.previewFile=t.searchUrlReset=t.searchUrl=t.commonLogFields=t.selectFilesForSelection=t.selectedFilesForSidebar=t.allFilesSelected=t.selectedFiles=t.fileCategoriesLogValue=t.fileCategoriesArray=t.fileCategoriesString=t.preferredEditors=t.isPaperEnabled=t.isNautilusEnabled=t.resultsList=t.results=t.calculateMediaDataDisplayInfo=t.mediaDataWithHighlights=t.numResults=t.resultsWithTags=t.resultsWithoutTags=t.viewTypeScope=t.isCreatingSharedLinkForFile=t.queriesForFields=t.filteredSuggestion=t.mediaData=t.selectedDimensions=t.dateTaken=t.queryStartTime=t.dwellStartTime=t.lastQueryWithPeopleSuggestionsLoaded=t.peopleSuggestionsCache=t.filteredAccountId=t.highlightedRow=t.searchType=t.ttiComponents=t.context=t.fileCategories=t.cachedFullResultsSortField=t.cachedFullResults=t.sortOrder=t.previewActiveCommentThreadId=t.previewFileId=t.hasMoreResults=t.spellCorrection=t.cursor=t.nextPageOffset=t.queryHistory=t.selection=t.requestId=t.sessionId=t.path=t.normalizedQuery=t.hasResultQuery=t.resultQuery=t.query=t.loadingState=t.userOptions=t.user=t.isFullPage=t.variant=void 0,n=r.__importStar(n),i=r.__importStar(i);var C=function(e){return g.getStateAtNamespace(e,d.SEARCH_NAMESPACE_KEY)};t.variant=function(e){return C(e).variant},t.isFullPage=function(e){return"full-page"===C(e).variant},t.user=function(e){return C(e).user},t.userOptions=function(e){return C(e).userOptions},t.loadingState=function(e){return C(e).loadingState},t.query=function(e){return C(e).query},t.resultQuery=function(e){return C(e).resultQuery},t.hasResultQuery=function(e){return!!C(e).resultQuery},t.normalizedQuery=function(e){return S.normalize(C(e).query)},t.path=function(e){return C(e).path},t.sessionId=function(e){return C(e).sessionId},t.requestId=function(e){return C(e).requestId},t.selection=function(e){return C(e).selection},t.queryHistory=function(e){return C(e).queryHistory},t.nextPageOffset=function(e){return C(e).results.count()},t.cursor=function(e){return C(e).cursor},t.spellCorrection=function(e){return C(e).spellCorrection},t.hasMoreResults=function(e){return C(e).hasMoreResults},t.previewFileId=function(e){return C(e).previewFileId},t.previewActiveCommentThreadId=function(e){return C(e).previewCommentsThreadId},t.sortOrder=function(e){return C(e).sortOrder},t.cachedFullResults=function(e){return C(e).cachedFullResults},t.cachedFullResultsSortField=function(e){return C(e).cachedFullResultsSortField},t.fileCategories=function(e){return C(e).fileCategories},t.context=function(e){return C(e).context},t.ttiComponents=function(e){return C(e).ttiComponents},t.searchType=function(e){return C(e).searchType},t.highlightedRow=function(e){return C(e).highlightedRow},t.filteredAccountId=function(e){return C(e).filteredAccountId},t.peopleSuggestionsCache=function(e){return C(e).peopleSuggestionsCache},t.lastQueryWithPeopleSuggestionsLoaded=function(e){return C(e).lastQueryWithPeopleSuggestionsLoaded},t.dwellStartTime=function(e){return C(e).dwellStartTime},t.queryStartTime=function(e){return C(e).queryStartTime},t.dateTaken=function(e){return C(e).dateTaken},t.selectedDimensions=function(e){return C(e).selectedDimensions},t.mediaData=function(e){return C(e).mediaData},t.filteredSuggestion=function(e){return C(e).filteredSuggestion},t.queriesForFields=s.createSelector(t.filteredSuggestion,(function(e){if(!(null==e?void 0:e.query))return[];var t=e.type,r=e.query,n="names"===t?y.SearchFields.FileName:"metadata"===t?y.SearchFields.ImageMetadata:void 0;return void 0===n?[]:[{raw_query:r,fields:[n]}]})),t.isCreatingSharedLinkForFile=function(e,t){return Boolean(C(e).isCreatingSharedLinkMap.get(t))};var A=function(){return h.getSearchCsrfToken()};t.viewTypeScope=s.createSelector(t.searchType,(function(e){return e===_.SearchType.IMAGE?E.VIEW_TYPE_SCOPE_IMAGE_SEARCH:E.VIEW_TYPE_SCOPE_TEXT_SEARCH})),t.resultsWithoutTags=function(e){return C(e).results};t.resultsWithTags=s.createSelector(t.resultsWithoutTags,w.selectTagsByFile,(function(e){var t;return F.isTaggingEnabled(null===(t=C(e).experiments)||void 0===t?void 0:t.manual_tagging)}),t.normalizedQuery,(function(e,t,r,n){return r?e.map((function(e){if(e instanceof o.File){var r=t[T.getFileMapKey(e)];void 0!==r&&(e=e.set("tags",r.map((function(e){return{value:e,highlighted:T.queryContainsTag(n,e.tag_text)}}))))}return e})):e})),t.numResults=s.createSelector(t.resultsWithoutTags,(function(e){return e.size})),t.mediaDataWithHighlights=s.createSelector(t.mediaData,t.normalizedQuery,(function(e,r){for(var n={},s=0,i=Object.keys(e);s<i.length;s++){var a=i[s];n[a]={data:e[a],display_info:t.calculateMediaDataDisplayInfo(e[a],r)}}return n}));var R=["file_id_or_path","image_height","image_width","date_taken"];t.calculateMediaDataDisplayInfo=function(e,t){var r=t.split(/[\s,]+/).filter((function(e){return""!==e&&!e.startsWith("#")}));if(0===r.length)return[];for(var n=r[r.length-1],s=[],i=0,a=Object.entries(e);i<a.length;i++){var o=a[i],l=o[0],u=o[1];if(!R.includes(l)&&u){var c=I(r,n,u);if(c.length){var d=b(c,u);s.push({field_name:l,highlights:d})}}}return s};var I=function(e,t,r){for(var n=t.toLowerCase(),s=r.toLowerCase(),i=[],a=0,o=e;a<o.length;a++)for(var l=o[a],u=l.toLowerCase(),c=u===n,d=s.indexOf(u),g=0;g<5&&0<=d;g++){L(u,s,d,c)&&i.push({token:l,index:d}),d=s.indexOf(u,d+1)}return i},L=function(e,t,r,n){var s=r>=0,i=e.length;if(!s||0===i)return!1;var a=r+i===t.length||[" ",","].includes(t[r+i]),o=r>0&&[" ",","].includes(t[r-1]);return(0===r||o)&&(n||a)},b=function(e,t){for(var n=[],s=0,i=0,a=r.__spreadArrays(e).sort((function(e,t){return e.index-t.index}));i<a.length;i++){var o=a[i],l=o.index,u=o.token;if(!(l<s||t.length<l+u.length)){var c=t.substring(l,l+u.length);s===l?n.push({highlight_str:c,is_highlighted:!0}):(n.push({highlight_str:t.substring(s,l),is_highlighted:!1}),n.push({highlight_str:c,is_highlighted:!0})),s=l+c.length}}return s<t.length&&n.push({highlight_str:t.substring(s),is_highlighted:!1}),n};t.results=s.createSelector(t.resultsWithTags,t.mediaDataWithHighlights,(function(e,t){return t?e.map((function(e){if(e instanceof o.File&&void 0!==t[e.file_id]){var r=t[e.file_id];e=e.set("media_data",r)}return e})):e})),t.resultsList=s.createSelector(t.results,(function(e){return e.toList()})),t.isNautilusEnabled=s.createSelector(t.userOptions,(function(e){return e&&e.nautilus_enabled})),t.isPaperEnabled=s.createSelector(t.userOptions,(function(e){return e&&e.paper_enabled})),t.preferredEditors=s.createSelector(t.user,t.userOptions,(function(e,t){var r,n;return e?t&&t.preferred_editors?((n={})[e.id]=t.preferred_editors,n):((r={})[e.id]={},r):{}})),t.fileCategoriesString=s.createSelector(t.fileCategories,(function(e){return h.fileCategoriesToString(e)})),t.fileCategoriesArray=s.createSelector(t.fileCategories,(function(e){return Object.keys(e).filter((function(t){return"checked"===e[t]}))})),t.fileCategoriesLogValue=s.createSelector(t.fileCategories,t.isPaperEnabled,(function(e,t){if(h.allCategoriesUnchecked(e,t))return["all_unchecked"];if(h.allCategoriesChecked(e,t))return["all_checked"];var r=[];return Object.keys(e).forEach((function(t){"checked"===e[t]&&r.push(t)})),r})),t.selectedFiles=s.createSelector(t.results,t.selection,(function(e,t){return D(e,t)})),t.allFilesSelected=s.createSelector(t.results,t.selectedFiles,(function(e,t){return e.size===t.size})),t.selectedFilesForSidebar=s.createSelector(t.selectedFiles,u.previewThumbnails,(function(e,t){return e.count()>0?e.withMutations((function(e){e.forEach((function(n,s){var i;if(!n.thumbnail_url_tmpl&&(null===(i=t[n.file_id])||void 0===i?void 0:i.preview_url)){var a=t[n.file_id].preview_url;n instanceof o.File?e.set(s,new o.File(r.__assign(r.__assign({},n),{thumbnail_url_tmpl:a}))):a&&e.set(s,new o.FileSharedWithMe(r.__assign(r.__assign({},n),{thumbnail_url_tmpl:a})))}}))})):e})),t.selectFilesForSelection=function(e,r){return D(t.results(e),r.selection)};var D=function(e,t){return n.OrderedMap(t.selected.toArray().filter((function(e){return!!e})).map((function(t){return[t,e.find((function(e){return"fq_path"in e?i.paths_are_equal(e.fq_path,t):e.file_id===t}))]})).filter((function(e){e[0];return!!e[1]})))},P=s.createSelector(t.resultsList,t.hasMoreResults,(function(e,t){return t?e.count()+1:e.count()}));t.commonLogFields=s.createSelector(t.user,t.path,t.query,t.sessionId,t.requestId,P,t.fileCategoriesLogValue,t.searchType,t.filteredAccountId,(function(e,t,r,n,s,a,o,l,u){return e?{user_id:e.id,active_user_id:e.id,path_scoped:!i.paths_are_equal(t),type:l===_.SearchType.IMAGE?"image_search":"single-page",query_string:r,typeahead_session_id:n,timezone_offset:p.getCurrentTimezoneOffset(),request_id:s,result_count:a,file_type_filters:o,search_scoped_to_account_id:u,source:m.searchNavigationManager.source}:{}})),t.searchUrl=s.createSelector(t.user,A,t.normalizedQuery,t.path,t.sessionId,t.previewFileId,t.fileCategoriesString,t.searchType,t.sortOrder,t.filteredAccountId,t.dateTaken,t.selectedDimensions,(function(e,t,r,n,s,i,o,u,d,g,p,f){if(e){var S=l.getQueryArgs().search_from;return h.buildSearchURL({user:e,searchPath:n,searchSessionId:s,searchToken:t,normalizedQuery:r,qargs:{search_from:S&&-1===m.DESKTOP_FROM_PATHS.indexOf(S)?S:void 0,preview:i,file_categories:o||void 0,search_type:u===_.SearchType.ALL?void 0:u,search_order_by:d.sortField===c.SortField.MODIFIED?a.SEARCH_ORDER_BY_TYPE.LAST_MODIFIED_TIME:void 0,search_reverse_order:d.sortDirection===c.SortDirection.ASCENDING?a.SEARCH_REVERSE_ORDER_TYPE.TRUE:void 0,search_account_id:g||void 0,search_date_taken:p!==y.DateTaken.Any?String(p):void 0,search_dimensions:f.length>0?h.dimensionsToURLParam(f):void 0}}).toString()}})),t.searchUrlReset=s.createSelector(t.user,A,t.normalizedQuery,t.sessionId,t.searchType,(function(e,t,r,n,s){if(e)return h.buildSearchURL({user:e,searchPath:"/",searchSessionId:n,searchToken:t,normalizedQuery:r,qargs:{search_from:l.getQueryArgs().search_from||void 0,search_type:s===_.SearchType.ALL?void 0:s}}).toString()})),t.previewFile=s.createSelector(t.previewFileId,t.results,(function(e,t){return e?t.find((function(t){return t instanceof o.File&&t.file_id===e})):void 0})),t.previewableFiles=s.createSelector(t.resultsList,(function(e){return e.filter((function(e){return e instanceof o.File&&!e.isDeleted&&!e.is_cloud_doc&&!e.is_dir})).toArray()})),t.ttiComponentsAllLoaded=s.createSelector(t.ttiComponents,(function(e){return 2===e.size})),t.hasFiltersSelected=s.createSelector(t.path,t.fileCategoriesArray,t.dateTaken,t.selectedDimensions,(function(e,t,r,n){return!(i.paths_are_equal(e,"/")&&0===t.length&&r===y.DateTaken.Any&&0===n.length)})),t.querySuggestionsCache=function(e){return C(e).querySuggestionsCache},t.lastQueryWithQuerySuggestionsLoaded=function(e){return C(e).lastQueryWithQuerySuggestionsLoaded},t.querySuggestions=s.createSelector(t.querySuggestionsCache,t.normalizedQuery,t.lastQueryWithQuerySuggestionsLoaded,(function(e,t,r){var n=e[t];return!r||n&&n.loadingState!==y.QuerySuggestionsLoadingState.LOADING?O(e,t):O(e,r)}));var O=function(e,t){var r=e[t];return r&&r.loadingState===y.QuerySuggestionsLoadingState.LOADED?r.suggestions:void 0};t.querySuggestionsLoadingState=s.createSelector(t.querySuggestionsCache,t.normalizedQuery,(function(e,t){return x(e,t)}));var x=function(e,t){var r=e[t];return r?r.loadingState:void 0};t.filteredContact=s.createSelector(t.peopleSuggestionsCache,t.filteredAccountId,(function(e,t){if(t){var r=e[""];return(r?r.contacts:[]).find((function(e){return e.dbx_account_id===t}))}})),t.filteredContactName=s.createSelector(t.filteredContact,(function(e){return e?e.name:void 0})),t.peopleSuggestions=s.createSelector(t.peopleSuggestionsCache,t.normalizedQuery,t.lastQueryWithPeopleSuggestionsLoaded,(function(e,t,r){var n=e[t];return!r||n&&n.loadingState!==y.PeopleSuggestionsLoadingState.LOADING?M(e,t):M(e,r)}));var M=function(e,t){var r=e[t];return r&&r.loadingState===y.PeopleSuggestionsLoadingState.LOADED?r.contacts.slice(0,Math.min(_.SEARCH_CONTACT_SUGGESTION_CAPACITY,r.contacts.length)):void 0};t.peopleSuggestionsLoadingState=s.createSelector(t.peopleSuggestionsCache,t.normalizedQuery,(function(e,t){var r=e[t];return r?r.loadingState:void 0})),t.tagsSuggestionsCache=function(e){return C(e).tagsSuggestionsCache},t.lastQueryWithTagsSuggestionsLoaded=function(e){return C(e).lastQueryWithTagsSuggestionsLoaded},t.tagsSuggestions=s.createSelector(t.tagsSuggestionsCache,t.normalizedQuery,t.lastQueryWithTagsSuggestionsLoaded,(function(e,t,r){var n=e[t];return!r||n&&n.loadingState!==y.TagsSuggestionsLoadingState.LOADING?N(e,t):N(e,r)}));var N=function(e,t){var r=e[t];return r&&r.loadingState===y.TagsSuggestionsLoadingState.LOADED?r.suggestions:void 0};t.tagsSuggestionsLoadingState=s.createSelector(t.tagsSuggestionsCache,t.normalizedQuery,(function(e,t){return Q(e,t)}));var Q=function(e,t){var r=e[t];return r?r.loadingState:void 0};t.popularFiltersCache=function(e){return C(e).popularFiltersCache},t.lastQueryWithPopularFiltersLoaded=function(e){return C(e).lastQueryWithPopularFiltersLoaded},t.popularFilters=s.createSelector(t.popularFiltersCache,t.normalizedQuery,t.lastQueryWithPopularFiltersLoaded,(function(e,t,r){var n=e[t];return!r||n&&n.loadingState!==y.PopularFiltersSuggestionsLoadingState.LOADING?k(e,t):k(e,r)}));var k=function(e,t){if(t){var r=e[t];return r&&r.loadingState===y.PopularFiltersSuggestionsLoadingState.LOADED?r.counts:void 0}};t.popularFiltersLoadingState=s.createSelector(t.popularFiltersCache,t.normalizedQuery,(function(e,t){return q(e,t)}));var q=function(e,t){var r=e[t];return r?r.loadingState:void 0};t.suggestions=s.createSelector(t.tagsSuggestions,t.peopleSuggestions,t.querySuggestions,t.popularFilters,t.resultQuery,(function(e,t,r,n,s){var i=[];return r&&i.push({suggestions:r.map((function(e){return{query:e.text,ariaLabel:v.intl.formatMessage({id:"ZFZrNG",defaultMessage:"Search for {query}"},{query:e.text}),highlightSpans:(e.highlight_spans||[]).map((function(e){return{string:e.highlight_str,isHighlighted:!!e.is_highlighted}}))}}))}),t&&i.push({title:v.intl.formatMessage({id:"s3VU9p",defaultMessage:"People"}),suggestions:t.map((function(e){return{id:e.dbx_account_id,initials:e.name.split(/\s+/).map((function(e){return"string"==typeof e[0]?e[0].toUpperCase():""})).join("").substr(0,2),avatar:e.photo_url||e.avatar_url,name:e.name,nameHighlights:f.getHighlightSpansForName({name:e.name,query:s})||[],emailAddress:e.email,emailAddressHighlights:f.getHighlightSpansForEmail({email:e.email,query:s})||[],ariaLabel:v.intl.formatMessage({id:"1q1f/B",defaultMessage:"Search for {name}"},{name:e.name})}}))}),e&&i.push({title:v.intl.formatMessage({id:"hI7tD7",defaultMessage:"Tags"}),suggestions:e.map((function(e){return{tag:e.tag_text,isSmartTag:T.isSuggestedTag(e)}}))}),n&&i.push({title:v.intl.formatMessage({id:"O8Fciq",defaultMessage:"-"}),suggestions:[{searchFilter:"all",count:n.all.count,hasMore:n.all.hasMore},{searchFilter:"names",count:n.names.count,hasMore:n.names.hasMore},{searchFilter:"metadata",count:n.metadata.count,hasMore:n.metadata.hasMore}]}),i})),t.highlightedSuggestion=s.createSelector(t.suggestions,t.highlightedRow,(function(e,t){if(void 0!==t)for(var r=0,n=0,s=e;n<s.length;n++){var i=s[n];if(void 0!==i.suggestions[t-r])return i.suggestions[t-r];r+=i.suggestions.length}})),t.selectResultById=function(e,r){return t.resultsList(e).find((function(e){return e instanceof o.File?e.fq_path===r.id:e instanceof o.FileSharedWithMe&&e.file_id===r.id}))},t.showViewModeToggle=function(e){return!(!t.resultQuery(e)&&!t.filteredAccountId(e)||t.resultsList(e).isEmpty())},t.browseCommentsEnabled=function(e){var t;return"ON"===(null===(t=C(e).experiments)||void 0===t?void 0:t.browse_web_comments)},t.getPage=function(e){return t.hasResultQuery(e)||t.filteredAccountId(e)?"search_results_page":"front_page"}})),define("modules/clean/search/single_page/data/store",["require","exports","modules/clean/react/files_view/data/store","modules/clean/redux/namespaces","modules/clean/redux/store","modules/clean/react/extensions/data/store","modules/clean/search/single_page/data/reducer","modules/clean/tagging/data/store"],(function(e,t,r,n,s,i,a,o){"use strict";var l;Object.defineProperty(t,"__esModule",{value:!0}),t.getStoreForSearch=void 0,t.getStoreForSearch=function(){var e;return l||(l=s.getStoreAndRegisterReducers(((e={})[n.SEARCH_NAMESPACE_KEY]=a.searchReducer,e))),r.getStoreForFilesView(),i.getStore(),o.getStoreForTagging(),l}})),define("modules/clean/search/single_page/filters",["require","exports","tslib","react","react-redux","typescript/component_libraries/retrieval-components/src/file-type-filter/index","modules/clean/logging/hive/schemas/web-modal-activity","modules/clean/react/folder_dialog/async","modules/clean/react/path_filter_button","modules/clean/search/constants","modules/clean/search/single_page/constants","modules/clean/search/single_page/data/action_creators/index","modules/clean/search/single_page/data/selectors/index","modules/clean/search/single_page/logger","modules/core/i18n","modules/clean/search/single_page/media_filters/media_filters","modules/clean/search/single_page/data/selectors/experiments","modules/clean/media_filters/gating"],(function(e,t,r,n,s,i,a,o,l,u,c,d,g,p,_,h,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchFilters=t.SearchFiltersComponent=void 0,n=r.__importDefault(n),d=r.__importStar(d),g=r.__importStar(g),m=r.__importStar(m);var S=(function(e){function t(t){var n=e.call(this,t)||this;return n.handlePathFilterButtonClick=function(){var e=n.props,t=e.user,r=e.path,s=e.setFilters;t&&o.showFolderDialog({ariaLabel:_.intl.formatMessage({id:"t+qFUO",defaultMessage:"Folder selector"}),canSelectReadonly:!0,initialPath:r,modalName:a.ModalName.SEARCH_FILTER,primaryActionLabel:_.intl.formatMessage({id:"hZgiKR",defaultMessage:"Select"}),title:_.intl.formatMessage({id:"BCJrz5",defaultMessage:"Select a folder"}),user:t,onSuccess:function(e){s({path:e||"/"})},useApiV2:!0})},n.handleFileTypeFilterChange=function(e){var t=r.__assign({},u.FILE_CATEGORIES_UNCHECKED);e.forEach((function(e){return t[e]="checked"})),n.props.setFilters({fileCategories:t}),p.logFileTypeFiltersChanged(e)},n.handleFileTypeFilterDropdownClicked=function(){n.setState({fileTypeFilterModalOpen:!0})},n.handleFileTypeFilterModalClose=function(){n.setState({fileTypeFilterModalOpen:!1})},n.setDimensions=function(e){n.props.setFilters({selectedDimensions:e})},n.setDateTaken=function(e){n.props.setFilters({dateTaken:e})},n.state={fileTypeFilterModalOpen:!1},n}return r.__extends(t,e),t.prototype.componentDidMount=function(){o.prewarmFolderDialog()},Object.defineProperty(t.prototype,"fileTypeFilterEntries",{get:function(){return this.props.isPaperEnabled?c.FILE_CATEGORIES_PAPER:c.FILE_CATEGORIES_NO_PAPER},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this.props,t=e.fileCategories,s=e.path,a=e.searchType,o=e.isScreenWidthMobile,c=e.selectedDimensions,d=e.dateTaken,g=e.shouldShowMediaFilters,p={entries:this.fileTypeFilterEntries,checkedCategories:t,onChange:this.handleFileTypeFilterChange,strings:{byType:_.intl.formatMessage({id:"Bdz08I",defaultMessage:"By type"}),selectAll:_.intl.formatMessage({id:"Ercy3i",defaultMessage:"Select all"}),clearAll:_.intl.formatMessage({id:"S5TT9D",defaultMessage:"Clear all"})}},m=this.setDimensions,f=this.setDateTaken,S=a!==u.SearchType.IMAGE;return n.default.createElement("div",{className:"search__filters"},n.default.createElement("div",{className:"search__filter search__filter--path"},n.default.createElement(l.PathFilterButton,{path:s,onClick:this.handlePathFilterButtonClick,defaultText:_.intl.formatMessage({id:"1jrD5R",defaultMessage:"Any folder"}),dropdownClasses:"search__filter-button",useDigComponents:!0,fullWidth:!0})),S?n.default.createElement("div",{className:"search__filter search__filter--file-type"},o?n.default.createElement(i.FileTypeFilterButton,r.__assign({},p,{triggerProps:{onClick:this.handleFileTypeFilterDropdownClicked,className:"search__filter-button"}})):n.default.createElement(i.FileTypeFilterDropdown,r.__assign({},p,{triggerProps:{className:"search__filter-button"}})),n.default.createElement(i.FileTypeFilterModal,r.__assign({modalProps:{title:_.intl.formatMessage({id:"197PGq",defaultMessage:"Filter"}),open:this.state.fileTypeFilterModalOpen,onRequestClose:this.handleFileTypeFilterModalClose,withCloseButton:_.intl.formatMessage({id:"2bDlQT",defaultMessage:"Close modal"})}},p))):null,g&&n.default.createElement("div",{className:"search__filter"},n.default.createElement(h.MediaFilters,r.__assign({},{selectedDimensions:c,dateTaken:d,setDimensions:m,setDateTaken:f}))))},t.displayName="SearchFiltersComponent",t})(n.default.PureComponent);t.SearchFiltersComponent=S;var y={setFilters:d.setFilters},v=s.connect((function(e){return{user:g.user(e),path:g.path(e),fileCategories:g.fileCategoriesArray(e),searchType:g.searchType(e),isPaperEnabled:g.isPaperEnabled(e),hasFiltersSelected:g.hasFiltersSelected(e),dateTaken:g.dateTaken(e),selectedDimensions:g.selectedDimensions(e),shouldShowMediaFilters:f.isMediaFiltersEnabled(m.mediaFiltersVariant(e)),loadingState:g.loadingState(e)}}),y);t.SearchFilters=v(S)})),define("modules/clean/search/single_page/header",["require","exports","tslib","react-redux","react","modules/clean/search/constants","modules/clean/search/single_page/data/selectors/index","modules/core/i18n","modules/clean/search/single_page/reset_filters","dig-components/typography","modules/clean/search/single_page/search_view_mode_toggle","modules/clean/react/browse/selection_indicator"],(function(e,t,r,n,s,i,a,o,l,u,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchHeader=t.SearchHeaderComponent=void 0,s=r.__importDefault(s),a=r.__importStar(a),t.SearchHeaderComponent=function(e){var t=e.loadingState,r=e.hasMoreResults,n=e.numResults,a=e.showViewModeToggle,g=e.responsive,p=e.selectedFiles;return s.default.createElement("header",{className:"search__header search__header--simplified"},s.default.createElement(u.Title,{className:"search__title"},(function(e,t,r){return e===i.SearchLoadingState.ZERO_QUERY?o.intl.formatMessage({id:"luV4IR",defaultMessage:"Filters"}):e===i.SearchLoadingState.LOADING_FIRST_PAGE?o.intl.formatMessage({id:"uitaX8",defaultMessage:"Searching..."}):t?o.intl.formatMessage({id:"i1llDx",defaultMessage:"{count, plural, one{{count}+ results} other{{count}+ results}}"},{count:r}):o.intl.formatMessage({id:"6J0O1e",defaultMessage:"{count, plural, one{{count} result} other{{count} results}}"},{count:r})})(t,r,n)),s.default.createElement(l.ResetFilters,null),s.default.createElement("div",{className:"search-selection-view-mode-container"},s.default.createElement(d.SelectionIndicator,{responsive:g,selectedFilesCount:p.count(),rightRailCollapsed:!1}),a&&s.default.createElement("div",{className:"search-viewmode-toggle-container"},s.default.createElement(c.SearchViewModeToggle,null))))},t.SearchHeaderComponent.displayName="SearchHeaderComponent";t.SearchHeader=n.connect((function(e){return{loadingState:a.loadingState(e),hasMoreResults:a.hasMoreResults(e),numResults:a.numResults(e),showViewModeToggle:a.showViewModeToggle(e),selectedFiles:a.selectedFiles(e)}}))(t.SearchHeaderComponent)})),define("modules/clean/search/single_page/input/chips",["require","exports","tslib","react","dig-components/chips","dig-components/icons","dig-components/icons/src","dig-components/text_fields","dig-components/tooltips","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar","modules/clean/avatar/size","modules/clean/filepath/filepath","modules/core/user_i18n"],(function(e,t,r,n,s,i,a,o,l,u,c,d,g,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchChips=void 0,n=r.__importStar(n),u=r.__importDefault(u),g=r.__importStar(g);var _=function(e){var t=e.children,s=e.tooltipContents,i=r.__rest(e,["children","tooltipContents"]),a=n.createRef(),o=n.useState(!1),u=o[0],c=o[1];return n.createElement(n.Fragment,null,n.createElement("span",r.__assign({ref:a,onMouseEnter:function(){a.current?a.current.offsetWidth<a.current.scrollWidth&&c(!0):c(!1)},onMouseLeave:function(){c(!1)}},i),t),n.createElement(l.Tooltip.Control,{triggerRef:a,open:u,auto:!0,placement:"bottom"},s))};_.displayName="TooltipIfTruncated";var h=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handlePathChipCloseClick=function(){t.props.setPath({path:"/",viewport:"chip"})},t.handlePeopleFilterChipCloseClick=function(){var e=t.props.setFilteredAccountId;e&&e({filteredAccountId:void 0})},t.handleSuggestionChipCloseClick=function(){var e=t.props.setFilteredSearchSuggestion;e&&e({type:void 0,query:""})},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.path,r=e.user,s=e.filteredContact,i=e.filteredSuggestion,a=e.hideText;return!(g.paths_are_equal(t,"/")&&!s&&(null==i||!i.type))?n.createElement(o.TextInput.ChipsContainer,null,g.paths_are_equal(t,"/")?null:n.createElement(m,{path:g.filename(t),isTeamMemberFolder:g.paths_are_equal(r&&r.cdm_tmf_path,t),onCloseClick:this.handlePathChipCloseClick,hideText:a}),s?n.createElement(f,{filteredContact:s,onCloseClick:this.handlePeopleFilterChipCloseClick,hideText:a}):null,i&&i.type?n.createElement(y,{filteredSuggestion:i,onCloseClick:this.handleSuggestionChipCloseClick,hideText:a}):null):n.createElement(n.Fragment,null)},t.displayName="SearchChips",t})(n.PureComponent);t.SearchChips=h;var m=function(e){var t=e.path,r=e.onCloseClick,o=e.hideText;return n.createElement(s.InputChip,{size:"small",className:"search-chips__chip",withIconLeft:n.createElement(i.UIIcon,{src:a.FolderFill,size:"small"}),onDelete:r,onClick:S,type:"button",tabIndex:-1},!o&&n.createElement(_,{className:"search-chips__chip-text",tooltipContents:t},t))},f=function(e){var t=e.filteredContact,r=e.onCloseClick,i=e.hideText;return n.createElement(s.InputChip,{size:"small",className:"search-chips__chip",onClick:S,tabIndex:-1,type:"button",withAvatarLeft:n.createElement(u.default,{dimension:d.AvatarSize.XSMALL,photoUrl:t.photo_url,shape:"CIRCLE",defaultAvatar:n.createElement(c.InitialsAvatarWithColorDerivedFromName,{dimension:d.AvatarSize.XSMALL,name:t.name,initials:p.getInitials(t.name),shape:"CIRCLE"})}),onDelete:r},!i&&n.createElement(_,{className:"search-chips__chip-text",tooltipContents:t.name},t.name))};function S(e){e.preventDefault(),e.stopPropagation()}f.displayName="PeopleFilterChip";var y=function(e){var t=e.filteredSuggestion,r=e.onCloseClick,o=e.hideText;return n.createElement(s.InputChip,{size:"small",className:"search-chips__chip",withIconLeft:"metadata"===t.type?n.createElement(i.UIIcon,{src:a.ImageLine,size:"small"}):n.createElement(i.UIIcon,{src:a.FileLine,size:"small"}),onDelete:r,onClick:S,type:"button",tabIndex:-1},!o&&n.createElement(_,{className:"search-chips__chip-text",tooltipContents:t.query||""},t.query||""))}})),define("modules/clean/search/single_page/input/connected",["require","exports","tslib","react-redux","modules/clean/search/single_page/data/action_creators/popular_filters","modules/clean/search/single_page/data/action_creators/index","modules/clean/search/single_page/data/selectors/index","modules/clean/search/single_page/data/selectors/experiments","modules/clean/search/single_page/input/component"],(function(e,t,r,n,s,i,a,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectedSearchInput=void 0,s=r.__importStar(s),i=r.__importStar(i),a=r.__importStar(a),o=r.__importStar(o);var u={setQuery:i.setQuery,setPath:i.setPath,clear:i.clear,dismissQuerySuggestions:i.dismissQuerySuggestions,setHighlightedRow:i.setHighlightedRow,setFilteredAccountId:i.setFilteredAccountId,dismissPeopleSuggestions:i.dismissPeopleSuggestions,dismissTagsSuggestions:i.dismissTagsSuggestions,onSearch:i.performSearch,dismissPopularFilters:s.dismissPopularFilters,setFilteredSearchSuggestion:i.setFilteredSearchSuggestion};t.ConnectedSearchInput=n.connect((function(e){return{query:a.query(e),path:a.path(e),querySuggestions:a.querySuggestions(e),highlightedRow:a.highlightedRow(e),filteredContact:a.filteredContact(e),peopleSuggestions:a.peopleSuggestions(e),tagsSuggestions:a.tagsSuggestions(e),results:a.resultsList(e),manualTaggingVariant:o.manualTaggingVariant(e),popularFilters:a.popularFilters(e),filteredSuggestion:a.filteredSuggestion(e)}}),u)(l.SearchInputComponent)})),define("modules/clean/search/single_page/input/suggestions",["require","exports","tslib","react","react-redux","typescript/component_libraries/retrieval-components/src/search-suggestions/index","modules/clean/search/single_page/data/action_creators/index","modules/clean/search/single_page/data/action_creators/popular_filters","modules/clean/search/single_page/data/selectors/experiments","modules/clean/search/single_page/data/selectors/index","modules/clean/search/single_page/logger","modules/clean/media_filters/gating","modules/clean/search/types","modules/clean/search/search_helpers","modules/clean/tagging/experiments"],(function(e,t,r,n,s,i,a,o,l,u,c,d,g,p,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectedSearchSuggestions=t.SearchSuggestionsComponent=void 0,n=r.__importDefault(n),a=r.__importStar(a),o=r.__importStar(o),l=r.__importStar(l),u=r.__importStar(u),c=r.__importStar(c);var h=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dismissSuggestions=function(){t.props.dismissQuerySuggestions({query:t.props.normalizedQuery}),t.props.dismissPeopleSuggestions({query:t.props.normalizedQuery}),_.isTaggingEnabled(t.props.manualTaggingVariant)&&t.props.dismissTagsSuggestions({query:p.normalizeForTagsSuggestions(t.props.normalizedQuery)}),d.isPopularFiltersSearchEnabled(t.props.mediaFiltersVariant)&&t.props.dismissPopularFilters({query:p.normalizeForTagsSuggestions(t.props.normalizedQuery)}),t.props.setHighlightedRow({index:void 0}),t.props.onFocusInput&&t.props.onFocusInput()},t.handleSuggestionClick=function(e){if("query"in e)c.logQuerySuggestionClicked(t.getIndexOfSuggestion(e),t.props.querySuggestions),t.props.setQuery({query:e.query,alwaysTriggerSearch:!0});else if("tag"in e){c.logTagSuggestionsClicked(t.getIndexOfSuggestion(e),t.props.tagsSuggestions);var r=p.updateQueryWithTagsSuggestion(t.props.normalizedQuery,e.tag);t.props.setQuery({query:r,alwaysTriggerSearch:!0})}else"searchFilter"in e?(c.logTypeaheadSuggestionClicked(e.searchFilter,e.count),"all"!==e.searchFilter?(t.props.setFilteredSearchSuggestion({type:e.searchFilter,query:t.props.normalizedQuery}),t.props.setQuery({query:""})):t.props.setQuery({query:t.props.normalizedQuery,alwaysTriggerSearch:!0})):(c.logPeopleFilterClicked(t.getIndexOfSuggestion(e),t.props.peopleSuggestions.length),t.props.setFilteredAccountId({filteredAccountId:e.id}),t.props.setQuery({query:""}));t.dismissSuggestions()},t.handleSuggestonHighlight=function(e){e?t.props.setHighlightedRow({index:t.getIndexOfSuggestion(e)}):t.props.setHighlightedRow({index:void 0})},t.getIndexOfSuggestion=function(e){for(var r=0,n=0,s=t.props.suggestions;n<s.length;n++){for(var i=s[n],a=0;a<=i.suggestions.length;a+=1)if(i.suggestions[a]===e)return a+r;r+=i.suggestions.length}},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.shouldLogQuerySuggestionsShown()&&c.logQuerySuggestionsDisplayed(this.props.querySuggestions),this.shouldLogPeopleSuggestionsShown()&&c.logPeopleFilterShown(this.props.peopleSuggestions.length),this.shouldLogTagsSuggestionsShown()&&c.logTagSuggestionsDisplayed(this.props.tagsSuggestions),this.shouldLogPopularFiltersShown()&&c.logTypeaheadSuggestionsDisplayed(this.props.popularFilters)},t.prototype.componentDidUpdate=function(e){!this.shouldLogQuerySuggestionsShown()||this.shouldLogQuerySuggestionsShown(e)&&this.props.normalizedQuery===e.normalizedQuery||c.logQuerySuggestionsDisplayed(this.props.querySuggestions),!this.shouldLogPeopleSuggestionsShown()||this.shouldLogPeopleSuggestionsShown(e)&&this.props.normalizedQuery===e.normalizedQuery||c.logPeopleFilterShown(this.props.peopleSuggestions.length),!this.shouldLogTagsSuggestionsShown()||this.shouldLogTagsSuggestionsShown(e)&&this.props.normalizedQuery===e.normalizedQuery||c.logTagSuggestionsDisplayed(this.props.tagsSuggestions),!this.shouldLogPopularFiltersShown()||this.shouldLogPopularFiltersShown(e)&&this.props.normalizedQuery===e.normalizedQuery||c.logTypeaheadSuggestionsDisplayed(this.props.popularFilters)},t.prototype.shouldLogQuerySuggestionsShown=function(e){return void 0===e&&(e=this.props),e.querySuggestionsLoadingState===g.QuerySuggestionsLoadingState.LOADED&&this.shouldShowQuerySuggestions(e)},t.prototype.shouldLogPeopleSuggestionsShown=function(e){return void 0===e&&(e=this.props),e.peopleSuggestionsLoadingState===g.PeopleSuggestionsLoadingState.LOADED&&this.shouldShowPeopleSuggestions(e)},t.prototype.shouldShowQuerySuggestions=function(e){var t=void 0===e?this.props:e,r=t.normalizedQuery,n=t.querySuggestions;return!!r&&!!n&&!!n.length},t.prototype.shouldShowPeopleSuggestions=function(e){var t=void 0===e?this.props:e,r=t.normalizedQuery,n=t.filteredAccountId,s=t.peopleSuggestions;return!(!r||n||!s||!s.length)},t.prototype.shouldLogTagsSuggestionsShown=function(e){return void 0===e&&(e=this.props),e.tagsSuggestionsLoadingState===g.TagsSuggestionsLoadingState.LOADED&&this.shouldShowTagsSuggestions(e)},t.prototype.shouldShowTagsSuggestions=function(e){var t=void 0===e?this.props:e,r=t.normalizedQuery,n=t.tagsSuggestions,s=t.manualTaggingVariant;return _.isTaggingEnabled(s)&&!!p.normalizeForTagsSuggestions(r)&&!!n&&!!n.length},t.prototype.shouldShowPopularFilters=function(e){var t=void 0===e?this.props:e,r=t.normalizedQuery,n=t.popularFilters,s=t.mediaFiltersVariant;return d.isPopularFiltersSearchEnabled(s)&&!!r.length&&!!n&&n.all.count>0},t.prototype.shouldLogPopularFiltersShown=function(e){return void 0===e&&(e=this.props),e.popularFiltersLoadingState===g.PopularFiltersSuggestionsLoadingState.LOADED&&this.shouldShowPopularFilters(e)},t.prototype.render=function(){var e=this.props,t=e.suggestions,r=e.highlightedSuggestion,s=e.manualTaggingVariant,a=e.normalizedQuery,o=this.shouldShowQuerySuggestions(),l=this.shouldShowPeopleSuggestions(),u=this.shouldShowTagsSuggestions(),c=this.shouldShowPopularFilters();return o||l||u||c?n.default.createElement("div",{className:"search__dropdown"},n.default.createElement(i.SearchSuggestions,{suggestions:t,onSuggestionClick:this.handleSuggestionClick,onSuggestionHighlight:this.handleSuggestonHighlight,ariaLabel:"",highlightedSuggestion:r,showTagsSuggestions:_.isTaggingEnabled(s),query:a,popularFilters:c?this.props.popularFilters:void 0})):null},t.displayName="SearchSuggestionsComponent",t})(n.default.PureComponent);t.SearchSuggestionsComponent=h;var m={setQuery:a.setQuery,dismissQuerySuggestions:a.dismissQuerySuggestions,setHighlightedRow:a.setHighlightedRow,dismissPeopleSuggestions:a.dismissPeopleSuggestions,setFilteredAccountId:a.setFilteredAccountId,dismissTagsSuggestions:a.dismissTagsSuggestions,dismissPopularFilters:o.dismissPopularFilters,setFilteredSearchSuggestion:a.setFilteredSearchSuggestion},f=s.connect((function(e){return{suggestions:u.suggestions(e),highlightedSuggestion:u.highlightedSuggestion(e),querySuggestions:u.querySuggestions(e),normalizedQuery:u.normalizedQuery(e),user:u.user(e),querySuggestionsLoadingState:u.querySuggestionsLoadingState(e),peopleSuggestionsLoadingState:u.peopleSuggestionsLoadingState(e),filteredAccountId:u.filteredAccountId(e),peopleSuggestions:u.peopleSuggestions(e),tagsSuggestions:u.tagsSuggestions(e),tagsSuggestionsLoadingState:u.tagsSuggestionsLoadingState(e),popularFilters:u.popularFilters(e),popularFiltersLoadingState:u.popularFiltersLoadingState(e),manualTaggingVariant:l.manualTaggingVariant(e),mediaFiltersVariant:l.mediaFiltersVariant(e)}}),m);t.ConnectedSearchSuggestions=f(h)})),define("modules/clean/search/single_page/logger",["require","exports","tslib","lodash","modules/clean/filepath/filepath","modules/clean/logging/hive/schemas/search-web_search_activity","modules/clean/logging/telemetry","modules/clean/react/browse/models","modules/clean/search/constants","modules/clean/search/logger","modules/clean/search/types","modules/clean/web_user_action_events","modules/clean/search/single_page/data/store","modules/clean/search/single_page/data/selectors/index"],(function(e,t,r,n,s,i,a,o,l,u,c,d,g,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logTypeaheadSuggestionRemoved=t.logTypeaheadSuggestionClicked=t.logTypeaheadSuggestionsDisplayed=t.logHistoryClickedInEmptyState=t.logEmptyStateLoaded=t.logEnrichedMediaDataReceived=t.logDimensionFilterChange=t.logDateTakenChange=t.logTagSuggestionsFailed=t.logTagSuggestionsFetched=t.logTagSuggestionsDismissed=t.logTagSuggestionsClicked=t.logTagSuggestionsDisplayed=t.logNavigateToResult=t.logQueryTyped=t.logSearchBoxFocus=t.logContextMenuClick=t.logPeopleFilterRemoved=t.logPeopleFilterClicked=t.logPeopleFilterShown=t.logPeopleFilterResponse=t.logSortOrderChanged=t.logFieldsFromResult=t.logQuerySuggestionsFailed=t.logQuerySuggestionsFetched=t.logQuerySuggestionsDismissed=t.logQuerySuggestionClicked=t.logQuerySuggestionsDisplayed=t.logSpellCorrectionClicked=t.logSpellCorrectionShown=t.logFiltersReset=t.logFileTypeFiltersChanged=t.logDwellTime=t.logImageSearchPromptShown=t.logSwitchSearchType=t.logScopeChipChanged=t.logHistoryCleared=t.logHistoryClicked=t.logHistoryAdded=t.logHistoryDisplayed=t.logResultAction=t.logQueryFailed=t.logQueryCompleted=t.logQueryStarted=t.hiveLogger=void 0,n=r.__importStar(n),a=r.__importStar(a),p=r.__importStar(p),t.hiveLogger=new a.HiveLogger;var _=function(){return p.commonLogFields(g.getStoreForSearch().getState())},h=function(e){return e!==l.SearchOriginPathway.WEB?{pathway:e}:void 0};t.logQueryStarted=function(e){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"query_started"},_()),{start:0,result_count:void 0,extra:h(e)})))},t.logQueryCompleted=function(e,n,s,a){var o=r.__assign(r.__assign({event_name:"query_completed"},_()),{latency:e});if(void 0!==s&&void 0!==a&&(o=r.__assign(r.__assign({},o),{extra:{tag_count:s.toString(),tag_action_surface:a}})),n){var l=o.extra,u=void 0===l?{}:l,c=r.__rest(o,["extra"]);u.media_metadata_search="ON",o=r.__assign(r.__assign({},c),{extra:u})}t.hiveLogger.log(new i.SearchWebSearchActivityRow(o))},t.logQueryFailed=function(e,n,s){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"query_failed"},_()),{latency:e,failure_type:n,extra:h(s)})))},t.logResultAction=function(e,n,s,a,o,l){var u=r.__assign(r.__assign(r.__assign({event_name:"result_action"},_()),t.logFieldsFromResult(s)),{action_type:e,position:n.indexOf(s),action_source:o});u.extra=r.__assign(r.__assign({},l),u.extra),a&&(u.extra=r.__assign(r.__assign({},u.extra),{action_surface:a})),t.hiveLogger.log(new i.SearchWebSearchActivityRow(u))},t.logHistoryDisplayed=function(e){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"recent_history_displayed"},_()),{recent_history_map:e.map((function(e){return e.rawQuery})).reduce((function(e,t,r){return e[r]=t,e}),{})})))},t.logHistoryAdded=function(e){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"recent_query_stored"},_()),{position:e})))},t.logHistoryClicked=function(e,n){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"recent_query_selected"},_()),{query_string:e,position:n})))},t.logHistoryCleared=function(){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign({event_name:"recent_history_cleared"},_())))},t.logScopeChipChanged=function(e,n){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"scope_chip_changed"},_()),{file_path:e,viewport:n})))},t.logSwitchSearchType=function(e,n,s){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"switch_search_type"},_()),{request_id:e,extra:{search_type:n,ref:s}})))},t.logImageSearchPromptShown=function(e,n){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"image_search_prompt_shown"},_()),{request_id:e,extra:{type:n}})))},t.logDwellTime=function(e,n){var s=p.resultQuery(g.getStoreForSearch().getState());t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"dwell_time"},_()),{query_string:s,view_type:n,extra:{dwell_time:e.toString()}})))},t.logFileTypeFiltersChanged=function(e){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"file_type_filter_changed"},_()),{file_type_filters:e})))},t.logFiltersReset=function(){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign({event_name:"filters_reset"},_())))},t.logSpellCorrectionShown=function(e){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"spell_correct_shown"},_()),{request_id:e.requestId,extra:{is_corrected:e.isCorrected.toString()}})))},t.logSpellCorrectionClicked=function(e){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"spell_correct_clicked"},_()),{request_id:e.requestId,extra:{is_corrected:e.isCorrected.toString()}})))},t.logQuerySuggestionsDisplayed=function(e){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"query_suggestions_displayed"},_()),{result_count:e.length,query_suggestion_strings:e.map((function(e){return e.text?e.text:""}))})))},t.logQuerySuggestionClicked=function(e,n){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"query_suggestions_clicked"},_()),{position:e,result_count:n.length,query_suggestion_strings:n.map((function(e){return e.text?e.text:""}))})))},t.logQuerySuggestionsDismissed=function(e){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"query_suggestions_dismissed"},_()),{query_string:e})))},t.logQuerySuggestionsFetched=function(e,n,s){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"query_suggestions_fetched"},_()),{query_string:e,result_count:n,latency:s})))},t.logQuerySuggestionsFailed=function(e){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"query_suggestions_failed"},_()),{query_string:e})))},t.logFieldsFromResult=function(e){return e instanceof o.File?{deleted:e.isDeleted,file_extension:s.file_extension_for_logging(e.fq_path),file_last_edited:e.ts,file_name:s.filename(e.fq_path),file_nsid:""+e.ns_id,file_size:e.bytes,file_sjid:""+e.sjid,match_type:e.match_type,result_id:e.ns_id+":"+e.sjid}:e instanceof o.Paper?{paper_pad_id:e.pad_id,result_id:e.pad_id}:e instanceof o.PaperFolder?{paper_folder_id:e.folder_id,result_id:e.folder_id}:e instanceof o.FileSharedWithMe?{deleted:!1,file_extension:s.file_extension_for_logging(e.filename),file_last_edited:e.ts,file_name:s.filename(e.filename),file_size:e.bytes,match_type:e.match_type,result_id:e.file_id,extra:{result_type:e.is_cloud_doc?u.SearchLogResultType.SHARED_CLOUD_DOC:u.SearchLogResultType.SHARED_DOC}}:{}},t.logSortOrderChanged=function(e){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"sort_results"},_()),{extra:{sort_field:e.sortField,sort_direction:e.sortDirection}})))},t.logPeopleFilterResponse=function(e){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"people_filter_response"},_()),{result_count:e})))},t.logPeopleFilterShown=function(e){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"people_filter_shown"},_()),{result_count:e})))},t.logPeopleFilterClicked=function(e,n){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"people_filter_clicked"},_()),{position:e,result_count:n})))},t.logPeopleFilterRemoved=function(){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign({event_name:"people_filter_removed"},_())))},t.logContextMenuClick=function(){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign({event_name:"context_menu_click"},_())))},t.logSearchBoxFocus=function(){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign({event_name:"search_box_focus"},_())))},t.logQueryTyped=function(e){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"query_typed"},_()),{query_string:e})))},t.logNavigateToResult=function(e,r,n,s){var i=r instanceof o.Paper||r instanceof o.PaperFolder?d.WebUserActionLogEvent.PAPER_OPEN:d.WebUserActionLogEvent.FILE_VIEW;t.logResultAction(i,e,r,n,s)},t.logTagSuggestionsDisplayed=function(e){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"tag_suggestions_displayed"},_()),{tag_suggestions_count:e.length.toString(),tag_suggestions_strings:e.map((function(e){return e.tag_text}))})))},t.logTagSuggestionsClicked=function(e,n){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"tag_suggestions_clicked"},_()),{position:e,tag_suggestions_count:n.length.toString(),tag_suggestions_strings:n.map((function(e){return e.tag_text}))})))},t.logTagSuggestionsDismissed=function(e){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"tag_suggestions_dismissed"},_()),{query_string:e})))},t.logTagSuggestionsFetched=function(e,n){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"tag_suggestions_fetched"},_()),{query_string:e,tag_suggestions_count:n.toString()})))},t.logTagSuggestionsFailed=function(e){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"tag_suggestions_failed"},_()),{query_string:e})))},t.logDateTakenChange=function(e,n){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"date_filter_changed"},_()),{extra:{date_filter:c.DateTaken[n],entry_point:e}})))},t.logDimensionFilterChange=function(e,n){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"dimension_filter_changed"},_()),{dimension_filter:n.map((function(e){return c.Dimensions[e]})),extra:{entry_point:e}})))},t.logEnrichedMediaDataReceived=function(e,s){var a=n.sumBy(e,(function(e){return n.isEmpty(p.calculateMediaDataDisplayInfo(e,s))?0:1}));t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"enriched_media_data_received"},_()),{extra:{num_of_results_with_media_data_highlights:a.toString()}})))},t.logEmptyStateLoaded=function(){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign({event_name:"empty_state_loaded"},_())))},t.logHistoryClickedInEmptyState=function(e,n){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"recent_query_selected"},_()),{query_string:e,position:n,extra:{entry_point:"empty_state_experiment"}})))},t.logTypeaheadSuggestionsDisplayed=function(e){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"typeahead_suggestions_displayed"},_()),{extra:{search_filters:JSON.stringify(Object.keys(e))}})))},t.logTypeaheadSuggestionClicked=function(e,n){var s=n||0;t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign(r.__assign({event_name:"typeahead_suggestions_clicked"},_()),{result_count:s,extra:{search_filter:e}})))},t.logTypeaheadSuggestionRemoved=function(){t.hiveLogger.log(new i.SearchWebSearchActivityRow(r.__assign({event_name:"typeahead_suggestions_removed"},_())))}})),define("modules/clean/search/single_page/media_filters/media_api",["require","exports","tslib","api_v2/default_user_client","modules/clean/react/files_view/util"],(function(e,t,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enrichedMediaDataFromApi=void 0,t.enrichedMediaDataFromApi=function(e,t){return r.__awaiter(this,void 0,Promise,(function(){var i,a,o;return r.__generator(this,(function(r){switch(r.label){case 0:return 0===(i=t.filter(s.isFile).map((function(e){return e.file_id}))).length?[2,{enriched_media_data:[]}]:(a=new n.DefaultUserApiV2Client(e),o={file_id_or_paths:i},[4,a.ns("media_tags_search").rpc("get_enriched_media_data",o,{})]);case 1:return[2,r.sent()]}}))}))}})),define("modules/clean/search/single_page/preview",["require","exports","tslib","react-redux","react","modules/clean/react/browse/constants","modules/clean/search/single_page/data/action_creators/index","modules/clean/search/single_page/data/selectors/index","modules/constants/python"],(function(e,t,r,n,s,i,a,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchPreview=t.SearchPreviewComponent=void 0,s=r.__importDefault(s),a=r.__importStar(a),o=r.__importStar(o);var u=(function(t){function n(){var s=null!==t&&t.apply(this,arguments)||this;return s.closeFileViewer=function(){new Promise((function(t,r){e(["modules/clean/react/file_viewer/controller"],t,r)})).then(r.__importStar).then((function(e){e.close()}))},s.handleFlipNext=function(){var e=s.props,t=e.previewFile,r=e.previewableFiles,n=e.setPreviewFileId;if(t&&!(r.length<2)){var i=r.indexOf(t);i<0||((i+=1)>=r.length&&(i=0),n({previewFileId:r[i].file_id}))}},s.handleFlipPrevious=function(){var e=s.props,t=e.previewFile,r=e.previewableFiles,n=e.setPreviewFileId;if(t&&!(r.length<2)){var i=r.indexOf(t);i<0||((i-=1)<0&&(i=r.length-1),n({previewFileId:r[i].file_id}))}},s.showFileViewer=function(){var t=s.props,i=t.user,a=t.previewableFiles,o=t.setPreviewFileId,u=t.setPreviewCommentsThreadId,c=t.previewFile,d=t.previewActiveCommentThreadId;i&&c&&new Promise((function(t,r){e(["modules/clean/react/file_viewer/controller"],t,r)})).then(r.__importStar).then((function(e){e.open(a,a.indexOf(c),i,n.containerId,{fileViewAction:l.FileViewActionType.CLICK,fileViewOrigin:l.FileViewOriginType.SEARCH,fileViewTarget:l.FileViewTargetType.PRIVATE,skipOuterRouting:!0,disableRouting:!0,onCloseViewer:function(){u({previewCommentsThreadId:void 0}),o({previewFileId:void 0})},onFlipNext:s.handleFlipNext,onFlipPrevious:s.handleFlipPrevious,activeCommentThreadId:d})}))},s}return r.__extends(n,t),n.prototype.componentDidMount=function(){this.showFileViewer()},n.prototype.componentDidUpdate=function(e){if(e.previewFile&&!this.props.previewFile)return this.props.setPreviewCommentsThreadId({previewCommentsThreadId:void 0}),void this.closeFileViewer();e.previewFile||!this.props.previewFile?e.previewFile&&this.props.previewFile&&this.props.previewFile.file_id!==e.previewFile.file_id&&this.showFileViewer():this.showFileViewer()},Object.defineProperty(n,"containerId",{get:function(){return document.getElementById("react-file-viewer")?"react-file-viewer":i.BROWSE_FILE_VIEWER_ELEMENT_ID},enumerable:!1,configurable:!0}),n.prototype.render=function(){return null},n.displayName="SearchPreviewComponent",n})(s.default.PureComponent);t.SearchPreviewComponent=u;var c={setPreviewFileId:a.setPreviewFile,setPreviewCommentsThreadId:a.setPreviewCommentsThreadId};t.SearchPreview=n.connect((function(e){return{user:o.user(e),previewFile:o.previewFile(e),previewableFiles:o.previewableFiles(e),previewActiveCommentThreadId:o.previewActiveCommentThreadId(e)}}),c)(u)})),define("modules/clean/search/single_page/tabs",["require","exports","tslib","react-redux","react","spectrum/tabbed_header/index","modules/clean/search/single_page/data/selectors/experiments","modules/clean/search/single_page/data/selectors/index"],(function(e,t,r,n,s,i,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchTabs=t.SearchTabsComponent=void 0,s=r.__importDefault(s),a=r.__importStar(a),o=r.__importStar(o);var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.onSwitchTab,r=e.searchType,n=e.tabs;return n&&n.length?s.default.createElement(i.TabbedHeader,{activeTabId:r,onSelection:t,className:"search__tabs"},n.map((function(e){var n=e.id,a=e.label;return s.default.createElement(i.Tab,{id:n,key:n,active:n===r,onClick:function(){return t(n,"tab")},className:"search__tab"},s.default.createElement("span",{className:"search__tab--contents"},a))}))):null},t.displayName="SearchTabsComponent",t})(s.default.PureComponent);t.SearchTabsComponent=l;t.SearchTabs=n.connect((function(e){return{searchType:o.searchType(e),tabs:a.tabs(e)}}),{})(l)})),define("modules/clean/search/single_page/utils",["require","exports","tslib","modules/clean/browse_uri_interface","modules/clean/react/browse/models","modules/clean/search/store_helpers","modules/core/browser"],(function(e,t,r,n,s,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.navigateToResult=t.getHighlightSpansForEmail=t.getHighlightSpansForName=t.getEscapedSearchQuery=t.getIdForSearchResult=t.generateRandomId=void 0,i=r.__importStar(i),t.generateRandomId=i.generateRandomId,t.getIdForSearchResult=function(e){return e instanceof s.File?e.file_id||e.fq_path:e instanceof s.Paper?e.pad_id:e instanceof s.PaperFolder?e.folder_id:e instanceof s.FileSharedWithMe?e.file_id:""},t.getEscapedSearchQuery=function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},t.getHighlightSpansForName=function(e){var r=e.name,n=e.query;if(n){for(var s,i=t.getEscapedSearchQuery(n),a=new RegExp("(^"+i+")|(\\s"+i+")","gi"),o=[];null!==(s=a.exec(r));)o.push({start:s.index,end:s.index+s[0].length});if(0!==o.length){for(var l=[],u=0;u<r.length&&o.length>0;){var c=o.shift();u<c.start&&l.push({string:r.substring(u,c.start),isHighlighted:!1}),l.push({string:r.substring(c.start,c.end),isHighlighted:!0}),u=c.end}return u<r.length&&l.push({string:r.substring(u),isHighlighted:!1}),l}}},t.getHighlightSpansForEmail=function(e){var r=e.email,n=e.query;if(r&&n){var s=t.getEscapedSearchQuery(n),i=r.indexOf(s);if(-1!==i){var a=[];return i>0&&a.push({string:r.substring(0,i),isHighlighted:!1}),a.push({string:r.substring(i,i+s.length),isHighlighted:!0}),i+s.length<r.length&&a.push({string:r.substring(i+s.length),isHighlighted:!1}),a}}},t.navigateToResult=function(e,t,r){var i=r?a.open_tab:a.redirect;e instanceof s.File&&i(n.href_for_file(t,e)),(e instanceof s.Paper||e instanceof s.PaperFolder)&&i(e.url),e instanceof s.FileSharedWithMe&&i(e.href)}})),define("modules/clean/search/single_page/view",["require","exports","tslib","classnames","lodash","react","react-intl","react-redux","dig-components/typography","modules/clean/browse_uri_interface","modules/clean/filepath/filepath","modules/clean/media_filters/gating","modules/clean/react/async/loadable","modules/clean/react/components/css","modules/clean/react/extensions/data/selectors","modules/clean/react/file_viewer/async_controller","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/data/selectors/files_view_selectors","modules/clean/react/files_view/data/selectors/instance_selectors","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/react/files_view/view_type","modules/clean/search/constants","modules/clean/search/search_results/view","modules/clean/search/single_page/data/action_creators/file_actions","modules/clean/search/single_page/data/action_creators/index","modules/clean/search/single_page/data/selectors/experiments","modules/clean/search/single_page/data/selectors/index","modules/clean/search/single_page/data/store","modules/clean/search/single_page/logger","modules/clean/search/single_page/navigation","modules/clean/search/single_page/preview","modules/clean/search/single_page/search_header_container","modules/clean/search/single_page/zero_query/index","modules/clean/sharing/browse_exports","modules/clean/user_survey/user_survey","modules/clean/web_timing_logger","modules/clean/web_user_action_events","modules/constants/python","modules/core/browser","modules/core/i18n","modules/core/uri"],(function(e,t,r,n,s,i,a,o,l,u,c,d,g,p,_,h,m,f,S,y,v,E,T,w,F,C,A,R,I,L,b,D,P,O,x,M,N,Q,k,q,V,U){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncErrorComponent=t.SearchView=t.ConnectedSearchViewWithProvider=t.SearchViewComponent=void 0,n=r.__importDefault(n),s=r.__importStar(s),i=r.__importDefault(i),c=r.__importStar(c),_=r.__importStar(_),m=r.__importStar(m),f=r.__importStar(f),S=r.__importStar(S),F=r.__importStar(F),C=r.__importStar(C),A=r.__importStar(A),R=r.__importStar(R),L=r.__importStar(L),q=r.__importStar(q);var W=(function(o){function l(t){var n=o.call(this,t)||this;return n.starredStoreListenerUnsubscribe=function(){},n.scrollContainer=i.default.createRef(),n.handleGetOverflowMenuActions=function(e,t,r){return[new Array]},n.handleRenderSharedWithController=function(){return null},n.handleGetIsFileJumping=function(){return!1},n.handleIsFileViewerShown=function(){return!!n.props.previewFile},n.handleShowShare=function(e,t){L.logResultAction(Q.WebUserActionLogEvent.SHARE,n.props.results,e),M.UserSurvey.trackEvent("share_item","browse"),x.asyncShowShareModal(n.props.user,e,{browseContext:n.props.context,origin:t})},n.handleSwitchViewType=function(e){n.props.setViewType({viewType:e,viewTypeScope:n.props.viewTypeScope,user:n.props.user})},n.filesViewActionHandlers={onDelete:function(t){new Promise((function(t,r){e(["modules/clean/react/browse/file_actions/action_handlers"],t,r)})).then(r.__importStar).then((function(e){(0,e.handleDelete)({user:n.props.user,files:t,isSearchMode:!0,viewType:n.props.viewType},n.props.context)}))},onShowRename:function(e){n.props.setFileRename({file:e,renameState:y.RenameState.PENDING_INPUT})},onSetClipboard:s.noop,onPasteFromClipboard:s.noop,onNewFolderSubmit:s.noop,onNewFolderCancel:s.noop,onRenameSubmit:function(e,t){n.props.renameFile({file:e,name:t,checkFSWs:!0})},onRenameCancel:function(e){return n.props.setFileRename({file:e,renameState:null})},onSwitchViewType:n.handleSwitchViewType,onColumnsChanged:s.noop,onCanDisplayFolderSizesChanged:s.noop,onAddFileJumpKeyCode:s.noop,onResetFileJump:s.noop,onShowShare:n.handleShowShare,onPresentInZoom:function(e){h.asyncOpenPreview({containerId:D.SearchPreviewComponent.containerId,files:[e],indexOfPreviewFile:0,shouldFocusComment:!1,user:n.props.user,onFileViewerDidMount:function(){},onFileViewerUnmount:function(){},fileViewAction:k.FileViewActionType.CLICK,fileViewOrigin:k.FileViewOriginType.SEARCH,fileViewTarget:k.FileViewTargetType.PRIVATE,shouldPresentInZoom:!0})}},n.handleSelectionChange=function(e,t){n.props.setSelection({selection:e,actionSource:t})},n.handleSearch=function(e,t,r){void 0===t||c.paths_are_equal(t,n.props.path)||n.props.setPath({path:t}),e!==n.props.normalizedQuery&&n.props.setQuery({query:e,alwaysTriggerSearch:!0})},n.handleLocationLinkClick=function(e,t){L.logResultAction(Q.WebUserActionLogEvent.CLICK_PATH_LINK,n.props.results,e),t||b.searchNavigationManager.set(u.get_browse_root(n.props.user)+U.URI.encode_parts(c.parent_dir(e.fq_path)))},n.handleOpenPaper=function(e){L.logResultAction(Q.WebUserActionLogEvent.PAPER_OPEN,n.props.results,e),q.redirect(e.url)},n.handleFileSharedWithMe=function(e){L.logResultAction(Q.WebUserActionLogEvent.FILE_VIEW,n.props.results,e),q.redirect(e.href)},n.handleRangeInView=function(e,t){n.props.loadingState===T.SearchLoadingState.LOADED&&n.props.hasMoreResults&&t===n.props.results.size-(n.props.viewType===E.ViewType.List?1:0)&&n.props.fetchNextPage()},n.handleSortOrderChanged=function(e,t){n.props.setSortOrder({sortOrder:{sortField:e,sortDirection:t}})},n.handleFocusSearchBar=function(){n.props.inputBox.current&&n.props.inputBox.current.focus()},n.handleStarClick=function(e,t){L.logResultAction(t?Q.WebUserActionLogEvent.STAR:Q.WebUserActionLogEvent.REMOVE_STAR,n.props.results,e)},n.onContainerClick=function(e){v.shouldClickDeselect(e)&&n.props.clearSelection({actionSource:Q.ActionSourceValue.WHITESPACE})},n.state={arePostTTIModulesLoaded:!1},t.loadViewTypes({user:t.user}),t.loadHistory(),n}return r.__extends(l,o),l.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,(function(){var t,n=this;return r.__generator(this,(function(s){switch(s.label){case 0:return this.props.handleComponentTTI({component:"view",query:this.props.resultQuery}),[4,N.waitForTTI()];case 1:return s.sent(),[4,Promise.all([new Promise((function(t,r){e(["modules/clean/react/starred/browse_exports"],t,r)})).then(r.__importStar)])];case 2:return t=s.sent()[0].StarredStore,this.starredStoreListenerUnsubscribe=t.addListener((function(){n.setState({starredState:t.getLoadingStates()})})),this.setState({arePostTTIModulesLoaded:!0}),[2]}}))}))},l.prototype.componentWillMount=function(){window.addEventListener("beforeunload",this.props.stopAndLogDwellTime)},l.prototype.componentDidUpdate=function(e){this.props.handleComponentTTI({component:"view",query:this.props.resultQuery}),this.props.onTTI&&this.props.ttiComponentsAllLoaded&&!e.ttiComponentsAllLoaded&&this.props.onTTI()},l.prototype.componentWillUnmount=function(){window.removeEventListener("beforeunload",this.props.stopAndLogDwellTime),this.starredStoreListenerUnsubscribe(),this.props.stopAndLogDwellTime()},l.prototype.hrefForFile=function(e,t){return u.href_for_file(e,t,{context:"search"})},l.prototype.render=function(){var e=this.props,r=e.user,o=e.responsive,l=e.results,u=e.context,c=e.loadingState,g=e.resultQuery,p=e.path,_=e.searchSessionId,h=e.viewType,m=e.selection,f=e.selectedFiles,S=e.searchType,y=e.filteredContactName,v=e.inputBox,E=e.requestId,F=e.setFilters,C=e.mediaFiltersVariant,A=o.isMatchedLarge;if(c===T.SearchLoadingState.LOAD_ERROR)return i.default.createElement(t.AsyncErrorComponent,null);if(c===T.SearchLoadingState.ZERO_QUERY){var R=d.isMediaFiltersEnabled(C)&&!1;return i.default.createElement("div",null,R&&i.default.createElement(P.SearchHeaderContainer,{responsive:o,isRightRailV2Enabled:!0,searchType:S,requestId:E,setFilters:F}),i.default.createElement(O.ZeroQueryView,{inputBox:v}))}var I=this.props.results.isEmpty()&&this.props.loadingState===T.SearchLoadingState.LOADED,L=n.default("search__view","maestro-content-scroll",{"maestro-content-scroll_scroll-disabled":c===T.SearchLoadingState.LOADING_FIRST_PAGE,"maestro-content-scroll--horizontal-scrollable":A});return i.default.createElement(a.RawIntlProvider,{value:V.intl},i.default.createElement(D.SearchPreview,null),i.default.createElement("div",{className:"search-view-container",onClick:this.onContainerClick},i.default.createElement(P.SearchHeaderContainer,{responsive:o,isRightRailV2Enabled:!0,searchType:S,requestId:E,setFilters:F}),i.default.createElement("div",{className:L,ref:this.scrollContainer},i.default.createElement("div",null,I?i.default.createElement(Y,{hasFiltersSelected:this.props.hasFiltersSelected,resetFiltersUrl:this.props.searchUrlReset,onResetFilters:this.props.resetFilters}):i.default.createElement("div",{className:"search-view--sticky-hack"},i.default.createElement(w.SearchResultsView,{filesViewActionHandlers:this.filesViewActionHandlers,searchResultsExperiments:this.props.searchResultsExperiments,browseExperiments:this.props.browseExperiments,maestroSearchBarProps:{},onFocusSearchBar:this.handleFocusSearchBar,onSearch:this.handleSearch,onScroll:s.noop,setFileUploaderPath:s.noop,onSelectionChange:this.handleSelectionChange,path:p,user:r,handleComponentTTI:s.noop,ensureFileViewerClosedIfNotPreviewing:s.noop,getIsFileJumping:this.handleGetIsFileJumping,isFileViewerShown:this.handleIsFileViewerShown,fileRename:this.props.fileRename,arePostTTIModulesLoaded:this.state.arePostTTIModulesLoaded,getOverflowMenuActions:this.handleGetOverflowMenuActions,onLocationLinkClick:this.handleLocationLinkClick,onNavigateToFileOrFolder:this.props.handleNavigateToFileOrFolder,onNavigateToParentFolder:s.noop,onOpenFileSharedWithMe:this.handleFileSharedWithMe,onOpenPaper:this.handleOpenPaper,context:u,hasMoreResults:!!this.props.hasMoreResults,loadingState:c,latestQuery:g,queryForResultsTitle:g,searchSessionId:_,searchResults:l,selection:m,selectedFiles:f,viewType:h,viewTypeScope:this.props.viewTypeScope,renderSharedWithController:this.handleRenderSharedWithController,hrefForFile:this.hrefForFile,responsive:o,onSearchFiltersChanged:this.props.setFilters,starredState:this.state.starredState,fileCategories:this.props.fileCategories,onSortChange:this.handleSortOrderChanged,searchType:S,sharingServiceInfo:this.props.sharingServiceInfo,onRangeInView:this.handleRangeInView,currentSort:this.props.sortOrder,onStarClick:this.handleStarClick,scrollContainer:this.scrollContainer,filteredContactName:y,isColumnResizingEnabled:A,useSkinnyCheckboxes:!0,mediaFiltersVariant:this.props.mediaFiltersVariant}))))))},l.displayName="SearchViewComponent",l})(i.default.PureComponent);t.SearchViewComponent=W;var H=I.getStoreForSearch(),z={setPath:C.setPath,setQuery:C.setQuery,setViewType:m.setViewType,loadViewTypes:m.loadViewTypes,setSelection:C.setSelection,clearSelection:C.clearSelection,loadHistory:C.loadHistory,setPreviewFile:C.setPreviewFile,setFileRename:m.setFileRename,handleComponentTTI:C.handleComponentTTI,fetchNextPage:C.fetchNextPage,renameFile:F.renameFile,setSortOrder:C.setSortOrder,restoreFiles:C.restoreFiles,setFilters:C.setFilters,resetFilters:C.resetFilters,stopAndLogDwellTime:C.stopAndLogDwellTime,handleNavigateToFileOrFolder:C.handleNavigateToFileOrFolder},G=o.connect((function(e){return{normalizedQuery:R.normalizedQuery(e),resultQuery:R.resultQuery(e),loadingState:R.loadingState(e),results:R.resultsList(e),path:R.path(e),searchSessionId:R.sessionId(e),requestId:R.requestId(e),viewType:S.selectViewType(e,{instanceId:T.SEARCH_FILES_VIEW_ID}),selectedFiles:R.selectedFiles(e),selection:R.selection(e),history:R.queryHistory(e),previewFile:R.previewFile(e),extensionsFeatureFlags:_.getFeatureFlags(e),sharingServiceInfo:_.sharingServiceInfo(e),fileCategories:R.fileCategories(e),context:R.context(e),fileRename:f.fileRename(e),hasMoreResults:R.hasMoreResults(e),searchType:R.searchType(e),sortOrder:R.sortOrder(e),searchResultsExperiments:A.searchResultsExperiments(e),browseExperiments:A.browseExperiments(e),hasFiltersSelected:R.hasFiltersSelected(e),searchUrlReset:R.searchUrlReset(e),preferredEditors:R.preferredEditors(e),experiments:A.experiments(e),shouldRenderTabs:A.shouldRenderTabs(e),filteredContactName:R.filteredContactName(e),shouldRenderInlineSearchFilters:A.shouldRenderInlineSearchFilters(e),ttiComponentsAllLoaded:R.ttiComponentsAllLoaded(e),viewTypeScope:R.viewTypeScope(e),mediaFiltersVariant:A.mediaFiltersVariant(e)}}),z)(W);t.ConnectedSearchViewWithProvider=function(e){return i.default.createElement(o.Provider,{store:H},i.default.createElement(G,r.__assign({},e)))};var B=g.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["dig-illustrations/spot/dog-digs"],t,r)})).then(r.__importStar)];case 1:return[2,t.sent().DogDigsSpot]}}))}))}});t.SearchView=p.requireCssWithComponent(t.ConnectedSearchViewWithProvider,["/static/css/search/view-vflQ1HULy.css","/static/css/browse/browse-vflZDvS0a.css","/static/css/browse/files_view-vflcwzlb4.css","/static/css/search/search_results-vflyvvipJ.css","/static/css/dig-illustrations/index.web-vflABEtwa.css"]);var Y=function(e){var t=e.hasFiltersSelected,r=e.resetFiltersUrl,n=e.onResetFilters;return i.default.createElement("div",{className:"search__view search__view--empty",id:"search-view"},i.default.createElement("div",{className:"search__view--illustration"},i.default.createElement(B,null)),i.default.createElement(l.Title,null,V.intl.formatMessage({id:"ZY55+d",defaultMessage:"No results found"})),i.default.createElement(l.Text,null,t?V.intl.formatMessage({id:"00FN2D",defaultMessage:"Try <LinkScope>resetting all filters</LinkScope>"},{LinkScope:function(e){return i.default.createElement("a",{href:r,onClick:(t=n,function(e){e.preventDefault(),t()})},e);var t}}):V.intl.formatMessage({id:"PtdLen",defaultMessage:"Try different keywords"})))};Y.displayName="NoResultsView",t.AsyncErrorComponent=g.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["modules/clean/react/browse/components/post_tti/error"],t,r)})).then(r.__importStar)];case 1:return[2,t.sent().ErrorComponent]}}))}))},loading:function(){return i.default.createElement("div",null,V.intl.formatMessage({id:"eU2b7o",defaultMessage:"Something went wrong. Please reload the page."}))},loadError:function(){return i.default.createElement("div",null,V.intl.formatMessage({id:"eU2b7o",defaultMessage:"Something went wrong. Please reload the page."}))}})})),define("modules/clean/search/single_page/zero_query/history",["require","exports","tslib","react","react-redux","dig-components/buttons","dig-components/icons","dig-components/icons/src","spectrum/media_table/index","spectrum/table/index","ts-keycode-enum","modules/clean/search/single_page/data/action_creators/index","modules/clean/search/single_page/data/selectors/experiments","modules/clean/search/single_page/data/selectors/index","modules/clean/search/single_page/logger","modules/core/i18n"],(function(e,t,r,n,s,i,a,o,l,u,c,d,g,p,_,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchHistoryViewInEmptyState=t.SearchHistoryView=t.SearchHistoryRow=t.SearchHistoryComponent=void 0,n=r.__importDefault(n),d=r.__importStar(d),g=r.__importStar(g),p=r.__importStar(p),_=r.__importStar(_);var m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleHistoryClick=function(e,r){t.props.setQuery({query:e.normalizedQuery,alwaysTriggerSearch:!0}),t.focusInputBox(),_.logHistoryClicked(e.normalizedQuery,r)},t.handleClearClick=function(){t.props.user&&(t.props.clearHistory(),t.focusInputBox())},t.focusInputBox=function(){t.props.inputBox.current&&t.props.inputBox.current.focus()},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.shouldRenderHistory&&_.logHistoryDisplayed(this.props.history)},t.prototype.componentDidUpdate=function(e){this.props.shouldRenderHistory&&e.shouldRenderHistory&&_.logHistoryDisplayed(this.props.history)},t.prototype.render=function(){var e=this,t=this.props,r=t.history;return t.shouldRenderHistory?n.default.createElement(u.Table,{className:"search__history",columnFlex:[10,"70px"],"aria-rowcount":r.length,"aria-describedby":"search__history-header"},n.default.createElement(u.TableHead,null,n.default.createElement(u.TableHeadCell,{id:"search__history-header"},h.intl.formatMessage({id:"pz0pE7",defaultMessage:"Recent searches"})),n.default.createElement(u.TableHeadCell,{align:"right"},n.default.createElement(i.Button,{onClick:this.handleClearClick,className:"search__history-clear",variant:"transparent",hasNoUnderline:!0},h.intl.formatMessage({id:"KZTpUR",defaultMessage:"Clear all"})))),n.default.createElement(u.TableBody,null,r.map((function(t,r){return n.default.createElement(f,{key:"history-"+r,history:t,index:r,onClick:e.handleHistoryClick})})))):null},t.displayName="SearchHistoryComponent",t})(n.default.PureComponent);t.SearchHistoryComponent=m;var f=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(){t.props.onClick(t.props.history,t.props.index)},t.handleKeyDown=function(e){switch(e.keyCode){case c.Key.Space:case c.Key.Enter:t.props.onClick(t.props.history,t.props.index)}},t}return r.__extends(t,e),t.prototype.render=function(){var e=this;return n.default.createElement(l.MediaRow,{onClick:this.handleClick,className:"search__history-item",tabIndex:0,onKeyDown:this.handleKeyDown},(function(t){var r=t.isHovered;return[n.default.createElement(l.MediaCell,{key:"text",icon:n.default.createElement(a.UIIcon,{src:o.SearchLine}),title:e.props.history.rawQuery,highlight:r})]}))},t.displayName="SearchHistoryRow",t})(n.default.PureComponent);t.SearchHistoryRow=f;var S=function(e){return{history:p.queryHistory(e),shouldRenderHistory:g.shouldRenderHistory(e),user:p.user(e)}},y={setQuery:d.setQuery,clearHistory:d.clearAllHistory};t.SearchHistoryView=s.connect(S,y)(m);var v=function(e){var t=e.history,r=e.inputBox,s=e.shouldRenderHistory,i=function(t,r){e.setQuery({query:t.normalizedQuery,alwaysTriggerSearch:!0}),a(),_.logHistoryClickedInEmptyState(t.normalizedQuery,r)},a=function(){r.current&&r.current.focus()};return s?n.default.createElement(u.Table,{className:"search__history-experiment",columnFlex:[10,"70px"],"aria-rowcount":t.length,"aria-describedby":"search__history-header"},n.default.createElement(u.TableBody,null,t.map((function(e,t){return n.default.createElement(f,{key:"history-"+t,history:e,index:t,onClick:i})})))):null};v.displayName="SearchHistoryInEmptyStateComponent",t.SearchHistoryViewInEmptyState=s.connect(S,y)(v)})),define("modules/clean/search/single_page/zero_query/index",["require","exports","tslib","classnames","react","react-redux","ts-keycode-enum","modules/clean/search/single_page/logger","modules/clean/tagging/logger","dig-components/typography","modules/clean/tagging/components/tags_container","modules/clean/react/home/recents/components/recent_activity_container","modules/clean/media_filters/gating","modules/clean/react/async/loadable","modules/clean/search/single_page/data/selectors/experiments","modules/clean/search/single_page/data/selectors/index","modules/clean/search/single_page/zero_query/history","modules/clean/tagging/experiments","modules/core/i18n","modules/clean/tagging/data/selectors/index","modules/clean/tagging/data/action_creators","modules/clean/tagging/utils","modules/clean/tagging/utils"],(function(e,t,r,n,s,i,a,o,l,u,c,d,g,p,_,h,m,f,S,y,v,E,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZeroQueryView=t.ZeroQueryComponent=t.AsyncLookBinocularsSpot=t.AsyncDogDigsSpot=t.AsyncFileOrganizerSpot=t.AsyncLookMagnifyingGlassSpot=void 0,n=r.__importDefault(n),s=r.__importDefault(s),o=r.__importStar(o),l=r.__importStar(l),_=r.__importStar(_),E=r.__importStar(E),t.AsyncLookMagnifyingGlassSpot=p.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["dig-illustrations/spot/look-magnifying-glass"],t,r)})).then(r.__importStar)];case 1:return[2,t.sent().LookMagnifyingGlassSpot]}}))}))}}),t.AsyncFileOrganizerSpot=p.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["dig-illustrations/spot/file-organizer"],t,r)})).then(r.__importStar)];case 1:return[2,t.sent().FileOrganizerSpot]}}))}))}}),t.AsyncDogDigsSpot=p.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["dig-illustrations/spot/dog-digs"],t,r)})).then(r.__importStar)];case 1:return[2,t.sent().DogDigsSpot]}}))}))}}),t.AsyncLookBinocularsSpot=p.Loadable({loader:function(){return r.__awaiter(void 0,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){e(["dig-illustrations/spot/look-binoculars"],t,r)})).then(r.__importStar)];case 1:return[2,t.sent().LookBinocularsSpot]}}))}))}});var w=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleKeyDown=function(e){e.keyCode===a.Key.Escape&&t.props.inputBox.current&&t.props.inputBox.current.focus()},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.shouldRenderEmptyZeroQueryView,i=e.inputBox,a=e.manualTaggingVariant,o=e.mediaFiltersVariant,l=e.searchEmptyStateVariant;return _.isEmptyStateExperiment(l)?s.default.createElement(A,{inputBox:i,manualTaggingEnabled:f.isTaggingEnabled(a)}):s.default.createElement("div",{className:n.default({search__view:!0,"search__view--empty":t}),id:"search-view",onKeyDown:this.handleKeyDown},s.default.createElement(m.SearchHistoryView,{inputBox:i}),s.default.createElement(F,r.__assign({},{shouldRenderEmptyZeroQueryView:t,manualTaggingVariant:a,mediaFiltersVariant:o})))},t.displayName="ZeroQueryComponent",t})(s.default.PureComponent);t.ZeroQueryComponent=w;var F=function(e){var t=e.shouldRenderEmptyZeroQueryView,r=e.manualTaggingVariant,n=e.mediaFiltersVariant;return t?g.isMediaFiltersEnabled(n)?s.default.createElement(L,null):f.isTaggingEnabled(r)?s.default.createElement(I,null):s.default.createElement(R,null):null},C=function(){return s.default.createElement("div",{className:"search__view--container"},s.default.createElement(u.Text,{color:"faint"},s.default.createElement(s.default.Fragment,null,S.intl.formatMessage({id:"cGLEHg",defaultMessage:"When your team has some tags, theyâ€™ll be here."}),s.default.createElement(u.Link,{href:"https://help.dropbox.com/files-folders/sort-preview/dropbox-tags",variant:"primary",hasNoUnderline:!0,target:"_blank",rel:"noopener noreferrer"},S.intl.formatMessage({id:"buAEr/",defaultMessage:"Learn about tags"})))),s.default.createElement("div",{className:"search__view--illustration"},s.default.createElement(t.AsyncFileOrganizerSpot,null)))};C.displayName="TagsEmptyStateOneLine";var A=function(e){var t=e.inputBox,r=e.manualTaggingEnabled,u=i.useDispatch(),g=i.useSelector(h.user);s.default.useEffect((function(){o.logEmptyStateLoaded()}),[]);var p=(i.useSelector(y.selectAllTagsSuggestions)||[]).map((function(e){return e.tag_text}));return s.default.useEffect((function(){u(v.fetchAllTagsSuggestions({user:g}))}),[]),s.default.createElement("div",{className:n.default({search__view:!0,"search__view--experiment":!0,"home-access":!0}),id:"search-view",onKeyDown:function(e){e.keyCode===a.Key.Escape&&t.current&&t.current.focus()}},s.default.createElement(b,{title:S.intl.formatMessage({id:"5ih958",defaultMessage:"Recent searches"})}),s.default.createElement(m.SearchHistoryViewInEmptyState,{inputBox:t}),r&&s.default.createElement(b,{title:S.intl.formatMessage({id:"DRRjxO",defaultMessage:"Your teamâ€™s top tags"})},p.length>0?s.default.createElement(c.TagsContainer,{tags:T.textTagsToUserGeneratedTags(p.slice(0,5)),onTagClick:function(e){l.logTagClick(g,[],"search_empty_state",e),E.redirectToSearchByTag(g,e.tag_text)}}):s.default.createElement(C,null)),s.default.createElement(b,{title:S.intl.formatMessage({id:"vOgmxs",defaultMessage:"Recently opened"})},s.default.createElement(d.RecentActivityContainerInSearchEmptyState,{key:"recent-activity-view",now:new Date,canRenderItems:!0,isHiddenByUser:!1,showHeader:!1,showAll:!1,fullItemView:!1})))};A.displayName="SearchEmptyState";var R=function(){return s.default.createElement(s.default.Fragment,null,s.default.createElement("div",{className:"search__view--illustration"},s.default.createElement(t.AsyncDogDigsSpot,null)),s.default.createElement(u.Title,null,S.intl.formatMessage({id:"MgR2x6",defaultMessage:"Begin typing to search"})),s.default.createElement(u.Text,{color:"faint",style:{textAlign:"center"}},S.intl.formatMessage({id:"CzRGuP",defaultMessage:"Search for files, folders, and content"})))};R.displayName="RegularEmptyState";var I=function(){return s.default.createElement(s.default.Fragment,null,s.default.createElement("div",{className:"search__view--illustration"},s.default.createElement(t.AsyncLookMagnifyingGlassSpot,null)),s.default.createElement(u.Title,null,S.intl.formatMessage({id:"HL+qET",defaultMessage:"Find files faster with #tags"})),s.default.createElement(u.Text,{color:"faint",style:{textAlign:"center"}},s.default.createElement(s.default.Fragment,null,S.intl.formatMessage({id:"IkMIV7",defaultMessage:"Search by name, contents, people, or tags."}),s.default.createElement("br",null),S.intl.formatMessage({id:"tqPF/r",defaultMessage:"Want to tag? Select a file or folder to get started."}))))};I.displayName="TagsEmptyState";var L=function(){return s.default.createElement(s.default.Fragment,null,s.default.createElement("div",{className:"search__view--illustration"},s.default.createElement(t.AsyncLookBinocularsSpot,null)),s.default.createElement(u.Title,null,S.intl.formatMessage({id:"FAygqJ",defaultMessage:"New ways to find your photos"})),s.default.createElement(u.Text,{color:"faint",style:{textAlign:"center"}},S.intl.formatMessage({id:"M6Nh+K",defaultMessage:"Type â€œdogâ€ to get your dog photos. Looking for{br}pics of a certain size, or from a given date? Try{br}the image properties filter."},{br:s.default.createElement("br",null)})))};L.displayName="MediaFiltersEmptyState";t.ZeroQueryView=i.connect((function(e){return{shouldRenderEmptyZeroQueryView:_.shouldRenderEmptyZeroQueryView(e),manualTaggingVariant:_.manualTaggingVariant(e),mediaFiltersVariant:_.mediaFiltersVariant(e),searchEmptyStateVariant:_.searchEmptyStateVariant(e)}}))(w);var b=function(e){var t=e.title,r=e.children;return s.default.createElement("div",null,s.default.createElement(u.Title,{size:"small",className:"search_empty_row_header"},t),r)};b.displayName="EmptyStateSection"})),define("typescript/component_libraries/retrieval-components/src/file-type-filter/index",["require","exports","tslib","classnames","react","dig-components/buttons","dig-components/controls","dig-components/menu","dig-components/modal","dig-components/tooltips","dig-components/typography","spectrum/icon_content/index","dig-components/chips"],(function(e,t,r,n,s,i,a,o,l,u,c,d,g){"use strict";function p(e){var t=e.strings,r=e.entries,n=e.checkedCategories,a=e.onChange;return s.createElement("header",{className:"rc-ftf-header"},s.createElement(c.Text,{size:"small",isBold:!0,color:"faint"},t.byType),s.createElement(i.Button,{variant:"transparent",onClick:function(){if(v(r,n))a([]);else{var e=r.map((function(e){return e.category}));a(E(e))}},size:"small"},v(r,n)?t.clearAll:t.selectAll))}Object.defineProperty(t,"__esModule",{value:!0}),t.areAllEntriesUnchecked=t.areAllEntriesChecked=t.FileTypeFilterDropdown=t.FileTypeFilterButton=t.FileTypeFilterModal=t.FileTypeFilterRow=t.FileTypeFilter=void 0,n=r.__importDefault(n);var _=(function(e){function t(){var t=e.apply(this,arguments)||this;return t.handleChange=function(e,n){var s=t.props,i=s.checkedCategories,a=s.onChange,o=i.filter((function(e){return e!==n}));e&&(o=r.__spreadArrays(o,[n])),a(E(o))},t}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,r=t.entries,n=t.checkedCategories;return s.createElement("div",{className:"rc-ftf"},s.createElement(p,Object.assign({},this.props)),s.createElement("ul",{className:"rc-ftf-list"},r.map((function(t){return s.createElement(h,Object.assign({key:t.label},t,{checked:n.indexOf(t.category)>-1,onChange:e.handleChange}))}))))},t})((s=r.__importStar(s)).Component);t.FileTypeFilter=_,_.displayName="FileTypeFilter";var h=(function(e){function t(){var t=e.apply(this,arguments)||this;return t.handleChange=function(e){var r=t.props,n=r.onChange,s=r.category;n(e.currentTarget.checked,s)},t}return r.__extends(t,e),t.prototype.render=function(){var e,t,r=this.props,i=r.label,o=r.icon,l=r.checked,d=r.tooltip;return s.createElement("li",null,s.createElement(c.Text,{tagName:"label",htmlFor:i,className:n.default({"rc-ftf-list__row":!0,"rc-ftf-list__row--checked":l})},s.createElement(a.Checkbox,{checked:l,onChange:this.handleChange,name:i,id:i}),(e=s.createElement("span",{className:"rc-ftf-list__row-name"},i),t=i,s.cloneElement(e,{onMouseEnter:function(r){r.currentTarget.title=r.currentTarget.scrollWidth>r.currentTarget.clientWidth?t:"",e.props.onMouseEnter&&e.props.onMouseEnter(r)}})),s.createElement(u.Tooltip,{placement:"left",title:d},s.createElement("span",null,s.createElement(y,{icon:o})))))},t})(s.Component);t.FileTypeFilterRow=h,h.displayName="FileTypeFilterRow";var m=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.modalProps,n=r.__rest(e,["modalProps"]);return s.createElement(l.Modal,Object.assign({},t),s.createElement(l.Modal.Header,{hasBottomSpacing:"title-small"},s.createElement(c.Title,{size:"small"},t.title)),s.createElement(l.Modal.Body,null,s.createElement(_,Object.assign({},n))))},t})(s.Component);t.FileTypeFilterModal=m,m.displayName="FileTypeFilterModal";var f=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.entries,r=e.checkedCategories,n=e.strings,i=e.triggerProps,a=t.filter((function(e){return r.indexOf(e.category)>-1})),o=1===a.length?a[0].label:n.byType;return s.createElement(g.FilterChip,Object.assign({},i,{withDropdownIcon:!0,className:"rc-ftf-button"}),a.length>1?o+" â€¢ "+a.length:o)},t})(s.Component);t.FileTypeFilterButton=f,f.displayName="FileTypeFilterButton";var S=(function(e){function t(){var t=e.apply(this,arguments)||this;return t.handleSelection=function(e){t.props.checkedCategories.includes(e)?t.props.onChange(r.__spreadArrays(t.props.checkedCategories).filter((function(t){return t!==e}))):t.props.onChange(r.__spreadArrays(t.props.checkedCategories,[e]))},t.handleOnMenuToggle=function(e){t.props.onMenuToggle&&t.props.onMenuToggle(e.isOpen)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,r=t.entries,n=t.checkedCategories;return s.createElement(o.Menu.Wrapper,{closeOnSelection:!1,onSelection:this.handleSelection,onToggle:this.handleOnMenuToggle},(function(t){var i=t.getContentProps,l=t.getTriggerProps;return s.createElement(s.Fragment,null,s.createElement(f,Object.assign({},e.props,{triggerProps:l()})),s.createElement(o.Menu.Content,Object.assign({},i(),{className:"rc-ftf-dropdown"}),s.createElement(p,Object.assign({},e.props)),s.createElement(o.Menu.Segment,null,r.map((function(e){var t=e.category,r=e.icon,i=e.label;return s.createElement(o.Menu.ActionItem,{key:t.toString(),value:t,"data-test-checked":n.indexOf(t)>-1,withLeftAccessory:s.createElement(a.Checkbox,{checked:n.indexOf(t)>-1,readOnly:!0,tabIndex:-1}),withRightAccessory:s.createElement(y,{icon:r})},i)})))))}))},t})(s.Component);t.FileTypeFilterDropdown=S,S.displayName="FileTypeFilterDropdown";var y=function(e){var t=e.icon;return s.createElement("span",{className:"rc-ftf-list__row-icon-content"},"string"==typeof t?s.createElement(d.IconContent,{name:t,role:"presentation"}):t)};function v(e,t){return e.every((function(e){return t.indexOf(e.category)>-1}))}function E(e){var t=new Set;e.forEach((function(e){return t.add(e)}));var r=[];return t.forEach((function(e){return r.push(e)})),r}y.displayName="FilterEntryIcon",t.areAllEntriesChecked=v,t.areAllEntriesUnchecked=function(e){return 0===e.length}}));
//# sourceMappingURL=pkg-search.min.js-vflPYF7gy.map